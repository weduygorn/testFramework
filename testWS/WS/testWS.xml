<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="7cce4187-62bf-44d2-916d-7a81a151d6bb" activeEnvironment="Default" name="testWS" resourceRoot="" soapui-version="5.3.0" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.actions.iface.tools.soapui.TestRunnerAction@values-local"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="Environment" value="Default"/>
  <con:entry key="Global Properties" value=""/>
  <con:entry key="TestSuite" value="&lt;all>"/>
  <con:entry key="Password" value=""/>
  <con:entry key="TestRunner Path" value=""/>
  <con:entry key="Tool Args" value=""/>
  <con:entry key="Ignore Errors" value="false"/>
  <con:entry key="Host:Port" value=""/>
  <con:entry key="user-settings.xml Password" value=""/>
  <con:entry key="WSS Password Type" value=""/>
  <con:entry key="Save Project" value="false"/>
  <con:entry key="Enable UI" value="false"/>
  <con:entry key="System Properties" value=""/>
  <con:entry key="Domain" value=""/>
  <con:entry key="Coverage Report" value="false"/>
  <con:entry key="Export JUnit Results" value="false"/>
  <con:entry key="Export JUnit Results with test properties" value="false"/>
  <con:entry key="Open Report" value="false"/>
  <con:entry key="Project Properties" value=""/>
  <con:entry key="Export All" value="false"/>
  <con:entry key="Project Password" value=""/>
  <con:entry key="Report Format(s)" value=""/>
  <con:entry key="TestCase" value="&lt;all>"/>
  <con:entry key="Print Report" value="false"/>
  <con:entry key="Username" value=""/>
  <con:entry key="Root Folder" value=""/>
  <con:entry key="Select Report Type" value=""/>
  <con:entry key="Save After" value="false"/>
  <con:entry key="Add Settings" value="false"/>
  <con:entry key="Endpoint" value=""/>
</xml-fragment>]]></con:setting></con:settings><con:interface xsi:type="con:WsdlInterface" id="502f0bfa-fccb-4524-8d8b-8820ebde1346" wsaVersion="NONE" name="SoapApiBinding" type="wsdl" bindingName="{https://acr.localhost/ws/SoapApi/0.1/}SoapApiBinding" soapVersion="1_1" anonymous="optional" definition="https://dev.amr.local/app_dev.php/ws/SoapApi" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart="https://dev.amr.local/app_dev.php/ws/SoapApi"><con:part><con:url>https://dev.amr.local/app_dev.php/ws/SoapApi</con:url><con:content><![CDATA[<definitions name="SoapApi" targetNamespace="https://acr.localhost/ws/SoapApi/0.1/" xmlns="http://schemas.xmlsoap.org/wsdl/" xmlns:tns="https://acr.localhost/ws/SoapApi/0.1/" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap-enc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/">
  <portType name="SoapApiPortType">
    <operation name="acr_JourneySearch">
      <input message="tns:acr_JourneySearchRequest"/>
      <output message="tns:acr_JourneySearchResponse"/>
    </operation>
    <operation name="acr_FareOfferSearch">
      <input message="tns:acr_FareOfferSearchRequest"/>
      <output message="tns:acr_FareOfferSearchResponse"/>
    </operation>
    <operation name="acr_GetJourneyRoute">
      <input message="tns:acr_GetJourneyRouteRequest"/>
      <output message="tns:acr_GetJourneyRouteResponse"/>
    </operation>
    <operation name="acr_PreBooking">
      <input message="tns:acr_PreBookingRequest"/>
      <output message="tns:acr_PreBookingResponse"/>
    </operation>
    <operation name="acr_Booking">
      <input message="tns:acr_BookingRequest"/>
      <output message="tns:acr_BookingResponse"/>
    </operation>
    <operation name="acr_GetBooking">
      <input message="tns:acr_GetBookingRequest"/>
      <output message="tns:acr_GetBookingResponse"/>
    </operation>
    <operation name="acr_PreRefund">
      <input message="tns:acr_PreRefundRequest"/>
      <output message="tns:acr_PreRefundResponse"/>
    </operation>
    <operation name="acr_Refund">
      <input message="tns:acr_RefundRequest"/>
      <output message="tns:acr_RefundResponse"/>
    </operation>
    <operation name="acr_GetRefund">
      <input message="tns:acr_GetRefundRequest"/>
      <output message="tns:acr_GetRefundResponse"/>
    </operation>
    <operation name="acr_GetCoupons">
      <input message="tns:acr_GetCouponsRequest"/>
      <output message="tns:acr_GetCouponsResponse"/>
    </operation>
    <operation name="acr_Cancel">
      <input message="tns:acr_CancelRequest"/>
      <output message="tns:acr_CancelResponse"/>
    </operation>
    <operation name="acr_GetBookingsList">
      <input message="tns:acr_GetBookingsListRequest"/>
      <output message="tns:acr_GetBookingsListResponse"/>
    </operation>
    <operation name="acr_CarSeatSearch">
      <input message="tns:acr_CarSeatSearchRequest"/>
      <output message="tns:acr_CarSeatSearchResponse"/>
    </operation>
    <operation name="acr_GetBalance">
      <input message="tns:acr_GetBalanceRequest"/>
      <output message="tns:acr_GetBalanceResponse"/>
    </operation>
  </portType>
  <types>
    <xsd:schema targetNamespace="https://acr.localhost/ws/SoapApi/0.1/">
      <xsd:complexType name="access">
        <xsd:all>
          <xsd:element name="resellerCode" type="xsd:string"/>
          <xsd:element name="userName" type="xsd:string"/>
          <xsd:element name="password" type="xsd:string"/>
          <xsd:element name="lang" type="xsd:string"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="originDestinationSearch">
        <xsd:all>
          <xsd:element name="originCode" type="xsd:string"/>
          <xsd:element name="originDate" type="xsd:date"/>
          <xsd:element name="originTimeFrom" type="xsd:string" nillable="true"/>
          <xsd:element name="originTimeTo" type="xsd:string" nillable="true"/>
          <xsd:element name="destinationCode" type="xsd:string"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="inboundOriginDestinationSearch">
        <xsd:all>
          <xsd:element name="originDate" type="xsd:date" nillable="true"/>
          <xsd:element name="originTimeFrom" type="xsd:string" nillable="true"/>
          <xsd:element name="originTimeTo" type="xsd:string" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="additionalOptions">
        <xsd:all>
          <xsd:element name="luggageOptions" type="xsd:string" nillable="true"/>
          <xsd:element name="seatNumbers" type="xsd:string" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="passenger">
        <xsd:all>
          <xsd:element name="passengerId" type="xsd:int" nillable="true"/>
          <xsd:element name="salutation" type="xsd:string" nillable="true"/>
          <xsd:element name="name" type="xsd:string" nillable="true"/>
          <xsd:element name="surname" type="xsd:string" nillable="true"/>
          <xsd:element name="patronymic" type="xsd:string" nillable="true"/>
          <xsd:element name="documentType" type="xsd:string" nillable="true"/>
          <xsd:element name="documentNumber" type="xsd:string" nillable="true"/>
          <xsd:element name="documentExpireDate" type="xsd:date" nillable="true"/>
          <xsd:element name="birthDate" type="xsd:date" nillable="true"/>
          <xsd:element name="nationality" type="xsd:string" nillable="true"/>
          <xsd:element name="residence" type="xsd:string" nillable="true"/>
          <xsd:element name="email" type="xsd:string" nillable="true"/>
          <xsd:element name="card" type="xsd:string" nillable="true"/>
          <xsd:element name="additionalOptions" type="tns:additionalOptions" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="passengers">
        <xsd:sequence>
          <xsd:element name="passenger" type="tns:passenger" minOccurs="1" maxOccurs="9"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="originDestination">
        <xsd:all>
          <xsd:element name="originCode" type="xsd:string"/>
          <xsd:element name="originName" type="xsd:string"/>
          <xsd:element name="originCountry" type="xsd:string"/>
          <xsd:element name="originDate" type="xsd:date"/>
          <xsd:element name="destinationCode" type="xsd:string"/>
          <xsd:element name="destinationName" type="xsd:string"/>
          <xsd:element name="destinationCountry" type="xsd:string"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="ticketOptions">
        <xsd:sequence>
          <xsd:element name="ticketOption" type="xsd:string" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="journeyInfo">
        <xsd:all>
          <xsd:element name="departureCode" type="xsd:string"/>
          <xsd:element name="departureName" type="xsd:string"/>
          <xsd:element name="departureCountry" type="xsd:string"/>
          <xsd:element name="departureDate" type="xsd:date"/>
          <xsd:element name="departureTime" type="xsd:string"/>
          <xsd:element name="arrivalCode" type="xsd:string"/>
          <xsd:element name="arrivalName" type="xsd:string"/>
          <xsd:element name="arrivalCountry" type="xsd:string"/>
          <xsd:element name="arrivalDate" type="xsd:date"/>
          <xsd:element name="arrivalTime" type="xsd:string"/>
          <xsd:element name="duration" type="xsd:string"/>
          <xsd:element name="faresAvailable" type="xsd:boolean"/>
          <xsd:element name="fareOfferType" type="xsd:int"/>
          <xsd:element name="netFare" type="xsd:float" nillable="true"/>
          <xsd:element name="markup" type="xsd:float" nillable="true"/>
          <xsd:element name="resellerMarkup" type="xsd:float" nillable="true"/>
          <xsd:element name="currency" type="xsd:string" nillable="true"/>
          <xsd:element name="ticketOptions" type="tns:ticketOptions" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="trainCategories">
        <xsd:sequence>
          <xsd:element name="trainCategory" type="xsd:string" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="amenities">
        <xsd:sequence>
          <xsd:element name="amenity" type="xsd:string" minOccurs="0" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="intermediateStation">
        <xsd:all>
          <xsd:element name="stationCode" type="xsd:string" nillable="true"/>
          <xsd:element name="stationName" type="xsd:string"/>
          <xsd:element name="stationCountry" type="xsd:string" nillable="true"/>
          <xsd:element name="stationArrivalTime" type="xsd:string" nillable="true"/>
          <xsd:element name="stationDepartureTime" type="xsd:string" nillable="true"/>
          <xsd:element name="stationStayTime" type="xsd:int" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="intermediateStations">
        <xsd:sequence>
          <xsd:element name="intermediateStation" type="tns:intermediateStation" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="route">
        <xsd:all>
          <xsd:element name="trainDepartureCode" type="xsd:string" nillable="true"/>
          <xsd:element name="trainDepartureName" type="xsd:string" nillable="true"/>
          <xsd:element name="trainDepartureCountry" type="xsd:string" nillable="true"/>
          <xsd:element name="trainArrivalCode" type="xsd:string" nillable="true"/>
          <xsd:element name="trainArrivalName" type="xsd:string" nillable="true"/>
          <xsd:element name="trainArrivalCountry" type="xsd:string" nillable="true"/>
          <xsd:element name="intermediateStations" type="tns:intermediateStations"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="journeySegment">
        <xsd:all>
          <xsd:element name="journeySegmentId" type="xsd:int"/>
          <xsd:element name="departureCode" type="xsd:string"/>
          <xsd:element name="departureName" type="xsd:string"/>
          <xsd:element name="departureCountry" type="xsd:string"/>
          <xsd:element name="departureDate" type="xsd:date"/>
          <xsd:element name="departureTime" type="xsd:string"/>
          <xsd:element name="arrivalCode" type="xsd:string"/>
          <xsd:element name="arrivalName" type="xsd:string"/>
          <xsd:element name="arrivalCountry" type="xsd:string"/>
          <xsd:element name="arrivalDate" type="xsd:date"/>
          <xsd:element name="arrivalTime" type="xsd:string"/>
          <xsd:element name="trainNumber" type="xsd:string"/>
          <xsd:element name="duration" type="xsd:string" nillable="true"/>
          <xsd:element name="transportType" type="xsd:string"/>
          <xsd:element name="operatorName" type="xsd:string"/>
          <xsd:element name="vendorName" type="xsd:string" nillable="true"/>
          <xsd:element name="trainName" type="xsd:string" nillable="true"/>
          <xsd:element name="trainCategories" type="tns:trainCategories" nillable="true"/>
          <xsd:element name="amenities" type="tns:amenities" nillable="true"/>
          <xsd:element name="route" type="tns:route" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="journeySegments">
        <xsd:sequence>
          <xsd:element name="journeySegment" type="tns:journeySegment" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="journey">
        <xsd:all>
          <xsd:element name="journeyId" type="xsd:int"/>
          <xsd:element name="journeyInfo" type="tns:journeyInfo"/>
          <xsd:element name="journeySegments" type="tns:journeySegments"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="journeys">
        <xsd:sequence>
          <xsd:element name="journey" type="tns:journey" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="roundtripJourneys">
        <xsd:sequence>
          <xsd:element name="journey" type="tns:journey" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="journeySearchResponse">
        <xsd:all>
          <xsd:element name="originDestination" type="tns:originDestination"/>
          <xsd:element name="roundtripOriginDestination" type="tns:originDestination" nillable="true"/>
          <xsd:element name="journeys" type="tns:journeys"/>
          <xsd:element name="roundtripJourneys" type="tns:roundtripJourneys" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="FareRule">
        <xsd:all>
          <xsd:element name="header" type="xsd:string" nillable="true"/>
          <xsd:element name="text" type="xsd:string" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="fareRules">
        <xsd:sequence>
          <xsd:element name="fareRule" type="tns:FareRule" minOccurs="0" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="Value">
        <xsd:all>
          <xsd:element name="code" type="xsd:string"/>
          <xsd:element name="name" type="xsd:string"/>
          <xsd:element name="netFare" type="xsd:float" nillable="true"/>
          <xsd:element name="markup" type="xsd:float" nillable="true"/>
          <xsd:element name="currency" type="xsd:string" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="values">
        <xsd:sequence>
          <xsd:element name="value" type="tns:Value" minOccurs="0" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="GenderCoupe">
        <xsd:all>
          <xsd:element name="perPassenger" type="xsd:boolean"/>
          <xsd:element name="mandatory" type="xsd:boolean"/>
          <xsd:element name="values" type="tns:values"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="SpecialRequests">
        <xsd:all>
          <xsd:element name="perPassenger" type="xsd:boolean"/>
          <xsd:element name="mandatory" type="xsd:boolean"/>
          <xsd:element name="values" type="tns:values"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="PossiblePositions">
        <xsd:all>
          <xsd:element name="perPassenger" type="xsd:boolean"/>
          <xsd:element name="mandatory" type="xsd:boolean"/>
          <xsd:element name="values" type="tns:values"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="LuggageOptions">
        <xsd:all>
          <xsd:element name="perPassenger" type="xsd:boolean"/>
          <xsd:element name="mandatory" type="xsd:boolean"/>
          <xsd:element name="values" type="tns:values"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="SeatNumbers">
        <xsd:all>
          <xsd:element name="perPassenger" type="xsd:boolean"/>
          <xsd:element name="mandatory" type="xsd:boolean"/>
          <xsd:element name="values" type="tns:values"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="Meals">
        <xsd:all>
          <xsd:element name="perPassenger" type="xsd:boolean"/>
          <xsd:element name="mandatory" type="xsd:boolean"/>
          <xsd:element name="values" type="tns:values"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="possibleBookingRequests">
        <xsd:all>
          <xsd:element name="wholeCoupe" type="xsd:boolean" nillable="true"/>
          <xsd:element name="diapasonSeat" type="xsd:boolean" nillable="true"/>
          <xsd:element name="oneCoupe" type="xsd:boolean" nillable="true"/>
          <xsd:element name="oneSection" type="xsd:boolean" nillable="true"/>
          <xsd:element name="noSideSleeper" type="xsd:boolean" nillable="true"/>
          <xsd:element name="lowerSleeper" type="xsd:boolean" nillable="true"/>
          <xsd:element name="upperSleeper" type="xsd:boolean" nillable="true"/>
          <xsd:element name="childMinTariff" type="xsd:boolean" nillable="true"/>
          <xsd:element name="noLinen" type="xsd:boolean" nillable="true"/>
          <xsd:element name="car" type="xsd:boolean" nillable="true"/>
          <xsd:element name="seats" type="xsd:boolean" nillable="true"/>
          <xsd:element name="genderCoupe" type="tns:GenderCoupe" nillable="true"/>
          <xsd:element name="specialRequests" type="tns:SpecialRequests" nillable="true"/>
          <xsd:element name="possiblePositions" type="tns:PossiblePositions" nillable="true"/>
          <xsd:element name="luggageOptions" type="tns:LuggageOptions" nillable="true"/>
          <xsd:element name="seatNumbers" type="tns:SeatNumbers" nillable="true"/>
          <xsd:element name="meals" type="tns:Meals" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="paxDataRequired">
        <xsd:all>
          <xsd:element name="salutation" type="xsd:boolean" nillable="true"/>
          <xsd:element name="name" type="xsd:boolean" nillable="true"/>
          <xsd:element name="documentType" type="xsd:boolean" nillable="true"/>
          <xsd:element name="documentNumber" type="xsd:boolean" nillable="true"/>
          <xsd:element name="documentExpireDate" type="xsd:boolean" nillable="true"/>
          <xsd:element name="birthDate" type="xsd:boolean"/>
          <xsd:element name="nationality" type="xsd:boolean" nillable="true"/>
          <xsd:element name="residence" type="xsd:boolean" nillable="true"/>
          <xsd:element name="email" type="xsd:boolean" nillable="true"/>
          <xsd:element name="birthDateForChildren" type="xsd:boolean" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="fareOffer">
        <xsd:all>
          <xsd:element name="fareOfferId" type="xsd:int"/>
          <xsd:element name="fareName" type="xsd:string" nillable="true"/>
          <xsd:element name="fareOfferType" type="xsd:int"/>
          <xsd:element name="serviceClass" type="xsd:string" nillable="true"/>
          <xsd:element name="serviceType" type="xsd:string" nillable="true"/>
          <xsd:element name="placeType" type="xsd:string" nillable="true"/>
          <xsd:element name="isEstimated" type="xsd:boolean" nillable="true"/>
          <xsd:element name="fareRules" type="tns:fareRules" nillable="true"/>
          <xsd:element name="netFare" type="xsd:float" nillable="true"/>
          <xsd:element name="markup" type="xsd:float" nillable="true"/>
          <xsd:element name="resellerMarkup" type="xsd:float" nillable="true"/>
          <xsd:element name="currency" type="xsd:string" nillable="true"/>
          <xsd:element name="ticketOptions" type="tns:ticketOptions"/>
          <xsd:element name="possibleBookingRequests" type="tns:possibleBookingRequests" nillable="true"/>
          <xsd:element name="amenities" type="tns:amenities" nillable="true"/>
          <xsd:element name="paxDataRequired" type="tns:paxDataRequired"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="fareOffers">
        <xsd:sequence>
          <xsd:element name="fareOffer" type="tns:fareOffer" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="roundtripFareOffers">
        <xsd:sequence>
          <xsd:element name="fareOffer" type="tns:fareOffer" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="fareOfferSearchResponse">
        <xsd:all>
          <xsd:element name="fareOffers" type="tns:fareOffers"/>
          <xsd:element name="roundtripFareOffers" type="tns:roundtripFareOffers" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="getJourneyRouteResponse">
        <xsd:all>
          <xsd:element name="journey" type="tns:journey"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="remark">
        <xsd:all>
          <xsd:element name="name" type="xsd:string"/>
          <xsd:element name="value" type="xsd:string"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="remarks">
        <xsd:sequence>
          <xsd:element name="remark" type="tns:remark" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="bookingRequest">
        <xsd:all>
          <xsd:element name="ticketOption" type="xsd:string"/>
          <xsd:element name="genderCoupe" type="xsd:string" nillable="true"/>
          <xsd:element name="diapasonSeatMin" type="xsd:int" nillable="true"/>
          <xsd:element name="diapasonSeatMax" type="xsd:int" nillable="true"/>
          <xsd:element name="oneCoupe" type="xsd:boolean" nillable="true"/>
          <xsd:element name="oneSection" type="xsd:boolean" nillable="true"/>
          <xsd:element name="noSideSleeper" type="xsd:boolean" nillable="true"/>
          <xsd:element name="noLinen" type="xsd:boolean" nillable="true"/>
          <xsd:element name="lowerSleeper" type="xsd:int" nillable="true"/>
          <xsd:element name="upperSleeper" type="xsd:int" nillable="true"/>
          <xsd:element name="childMinTariff" type="xsd:boolean" nillable="true"/>
          <xsd:element name="specialRequests" type="xsd:string" nillable="true"/>
          <xsd:element name="possiblePositions" type="xsd:string" nillable="true"/>
          <xsd:element name="luggageOptions" type="xsd:string" nillable="true"/>
          <xsd:element name="remarks" type="tns:remarks" nillable="true"/>
          <xsd:element name="paymentType" type="xsd:string" nillable="true"/>
          <xsd:element name="car" type="xsd:string" nillable="true"/>
          <xsd:element name="seats" type="xsd:string" nillable="true"/>
          <xsd:element name="meals" type="xsd:string" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="contactDetails">
        <xsd:all>
          <xsd:element name="title" type="xsd:string" nillable="true"/>
          <xsd:element name="name" type="xsd:string" nillable="true"/>
          <xsd:element name="surname" type="xsd:string" nillable="true"/>
          <xsd:element name="flat" type="xsd:string" nillable="true"/>
          <xsd:element name="buildingName" type="xsd:string" nillable="true"/>
          <xsd:element name="buildingNumber" type="xsd:string" nillable="true"/>
          <xsd:element name="street" type="xsd:string" nillable="true"/>
          <xsd:element name="city" type="xsd:string" nillable="true"/>
          <xsd:element name="postcode" type="xsd:string" nillable="true"/>
          <xsd:element name="country" type="xsd:string" nillable="true"/>
          <xsd:element name="internationalCode" type="xsd:string" nillable="true"/>
          <xsd:element name="areaCode" type="xsd:string" nillable="true"/>
          <xsd:element name="number" type="xsd:string" nillable="true"/>
          <xsd:element name="extension" type="xsd:string" nillable="true"/>
          <xsd:element name="email" type="xsd:string" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="coupon">
        <xsd:all>
          <xsd:element name="couponId" type="xsd:int"/>
          <xsd:element name="couponPdf" type="xsd:string" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="coupons">
        <xsd:sequence>
          <xsd:element name="coupon" type="tns:coupon" minOccurs="0" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="booking">
        <xsd:all>
          <xsd:element name="bookingId" type="xsd:int"/>
          <xsd:element name="operatorBookingId" type="xsd:string" nillable="true"/>
          <xsd:element name="status" type="xsd:string"/>
          <xsd:element name="createDate" type="xsd:date"/>
          <xsd:element name="createTime" type="xsd:string"/>
          <xsd:element name="confirmLimit" type="xsd:int" nillable="true"/>
          <xsd:element name="fareId" type="xsd:int" nillable="true"/>
          <xsd:element name="ticketType" type="xsd:string" nillable="true"/>
          <xsd:element name="paymentType" type="xsd:string" nillable="true"/>
          <xsd:element name="coupons" type="tns:coupons" nillable="true"/>
          <xsd:element name="couponsMessage" type="xsd:string" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="seat">
        <xsd:all>
          <xsd:element name="ticketId" type="xsd:int"/>
          <xsd:element name="journeySegmentId" type="xsd:int"/>
          <xsd:element name="placeNumber" type="xsd:string"/>
          <xsd:element name="carNumber" type="xsd:string"/>
          <xsd:element name="deck" type="xsd:int" nillable="true"/>
          <xsd:element name="serviceClass" type="xsd:string" nillable="true"/>
          <xsd:element name="serviceType" type="xsd:string" nillable="true"/>
          <xsd:element name="placeType" type="xsd:string" nillable="true"/>
          <xsd:element name="orientation" type="xsd:string" nillable="true"/>
          <xsd:element name="genderCoupe" type="xsd:string" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="seats">
        <xsd:sequence>
          <xsd:element name="seat" type="tns:seat" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="ticket">
        <xsd:all>
          <xsd:element name="ticketId" type="xsd:int"/>
          <xsd:element name="bookingId" type="xsd:int"/>
          <xsd:element name="ticketSupplierId" type="xsd:string" nillable="true"/>
          <xsd:element name="passengerId" type="xsd:int"/>
          <xsd:element name="fareId" type="xsd:int" nillable="true"/>
          <xsd:element name="ticketType" type="xsd:string" nillable="true"/>
          <xsd:element name="coupons" type="tns:coupons" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="tickets">
        <xsd:sequence>
          <xsd:element name="ticket" type="tns:ticket" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="fare">
        <xsd:all>
          <xsd:element name="fareId" type="xsd:int"/>
          <xsd:element name="netFare" type="xsd:float"/>
          <xsd:element name="markup" type="xsd:float"/>
          <xsd:element name="resellerMarkup" type="xsd:float" nillable="true"/>
          <xsd:element name="currency" type="xsd:string"/>
          <xsd:element name="prodMarketingName" type="xsd:string" nillable="true"/>
          <xsd:element name="tariffCode" type="xsd:string" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="fares">
        <xsd:sequence>
          <xsd:element name="fare" type="tns:fare" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="ancillaryService">
        <xsd:all>
          <xsd:element name="ancillaryServiceId" type="xsd:string"/>
          <xsd:element name="passengerId" type="xsd:int"/>
          <xsd:element name="fareId" type="xsd:int" nillable="true"/>
          <xsd:element name="type" type="xsd:string" nillable="true"/>
          <xsd:element name="value" type="xsd:string" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="ancillaryServices">
        <xsd:sequence>
          <xsd:element name="ancillaryService" type="tns:ancillaryService" minOccurs="0" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="preBookingResponse">
        <xsd:all>
          <xsd:element name="booking" type="tns:booking"/>
          <xsd:element name="roundtripBooking" type="tns:booking" nillable="true"/>
          <xsd:element name="seats" type="tns:seats"/>
          <xsd:element name="tickets" type="tns:tickets"/>
          <xsd:element name="passengers" type="tns:passengers"/>
          <xsd:element name="fares" type="tns:fares"/>
          <xsd:element name="ancillaryServices" type="tns:ancillaryServices" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="creditCard">
        <xsd:all>
          <xsd:element name="cardholderName" type="xsd:string" nillable="true"/>
          <xsd:element name="cardType" type="xsd:string" nillable="true"/>
          <xsd:element name="cardNumber" type="xsd:string" nillable="true"/>
          <xsd:element name="cvv" type="xsd:string" nillable="true"/>
          <xsd:element name="expiryDate" type="xsd:date" nillable="true"/>
          <xsd:element name="addressLine" type="xsd:string" nillable="true"/>
          <xsd:element name="postcode" type="xsd:string" nillable="true"/>
          <xsd:element name="country" type="xsd:string" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="bookingResponse">
        <xsd:all>
          <xsd:element name="booking" type="tns:booking"/>
          <xsd:element name="roundtripBooking" type="tns:booking" nillable="true"/>
          <xsd:element name="fares" type="tns:fares"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="bookingJourney">
        <xsd:all>
          <xsd:element name="journeyInfo" type="tns:journeyInfo"/>
          <xsd:element name="journeySegments" type="tns:journeySegments"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="getBookingResponse">
        <xsd:all>
          <xsd:element name="booking" type="tns:booking"/>
          <xsd:element name="bookingJourney" type="tns:bookingJourney"/>
          <xsd:element name="roundtripBooking" type="tns:booking" nillable="true"/>
          <xsd:element name="roundtripBookingJourney" type="tns:bookingJourney" nillable="true"/>
          <xsd:element name="seats" type="tns:seats"/>
          <xsd:element name="tickets" type="tns:tickets"/>
          <xsd:element name="passengers" type="tns:passengers"/>
          <xsd:element name="fares" type="tns:fares"/>
          <xsd:element name="ancillaryServices" type="tns:ancillaryServices" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="refund">
        <xsd:all>
          <xsd:element name="refundId" type="xsd:int"/>
          <xsd:element name="status" type="xsd:string"/>
          <xsd:element name="bookingId" type="xsd:int"/>
          <xsd:element name="createDate" type="xsd:date"/>
          <xsd:element name="createTime" type="xsd:string"/>
          <xsd:element name="confirmLimit" type="xsd:int" nillable="true"/>
          <xsd:element name="fareId" type="xsd:int" nillable="true"/>
          <xsd:element name="coupons" type="tns:coupons" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="refundTicket">
        <xsd:all>
          <xsd:element name="refundId" type="xsd:int"/>
          <xsd:element name="refundTicketId" type="xsd:int"/>
          <xsd:element name="ticketId" type="xsd:int"/>
          <xsd:element name="passengerId" type="xsd:int"/>
          <xsd:element name="fareId" type="xsd:int"/>
          <xsd:element name="coupons" type="tns:coupons" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="refundTickets">
        <xsd:sequence>
          <xsd:element name="refundTicket" type="tns:refundTicket" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="preRefundResponse">
        <xsd:all>
          <xsd:element name="refund" type="tns:refund"/>
          <xsd:element name="refundRoundtrip" type="tns:refund" nillable="true"/>
          <xsd:element name="refundTickets" type="tns:refundTickets"/>
          <xsd:element name="passengers" type="tns:passengers"/>
          <xsd:element name="fares" type="tns:fares"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="refundResponse">
        <xsd:all>
          <xsd:element name="refund" type="tns:refund"/>
          <xsd:element name="refundRoundtrip" type="tns:refund" nillable="true"/>
          <xsd:element name="fares" type="tns:fares"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="getRefundResponse">
        <xsd:all>
          <xsd:element name="refund" type="tns:refund"/>
          <xsd:element name="refundTickets" type="tns:refundTickets"/>
          <xsd:element name="passengers" type="tns:passengers"/>
          <xsd:element name="fares" type="tns:fares"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="getCouponsResponse">
        <xsd:all>
          <xsd:element name="coupons" type="tns:coupons"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="cancelResponse">
        <xsd:all>
          <xsd:element name="booking" type="tns:booking"/>
          <xsd:element name="roundtripBooking" type="tns:booking" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="bookings">
        <xsd:sequence>
          <xsd:element name="booking" type="tns:booking" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="refunds">
        <xsd:sequence>
          <xsd:element name="refund" type="tns:refund" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="getBookingsListResponse">
        <xsd:all>
          <xsd:element name="bookings" type="tns:bookings"/>
          <xsd:element name="refunds" type="tns:refunds"/>
          <xsd:element name="fares" type="tns:fares"/>
          <xsd:element name="tickets" type="tns:tickets"/>
          <xsd:element name="refundTickets" type="tns:refundTickets"/>
          <xsd:element name="passengers" type="tns:passengers"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="availableSeats">
        <xsd:sequence>
          <xsd:element name="placeNumber" type="xsd:string" minOccurs="0" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="car">
        <xsd:all>
          <xsd:element name="carNumber" type="xsd:string"/>
          <xsd:element name="carOwner" type="xsd:string" nillable="true"/>
          <xsd:element name="seaters" type="xsd:int" nillable="true"/>
          <xsd:element name="lowerSleeper" type="xsd:int" nillable="true"/>
          <xsd:element name="upperSleeper" type="xsd:int" nillable="true"/>
          <xsd:element name="lowerSideSleeper" type="xsd:int" nillable="true"/>
          <xsd:element name="upperSideSleeper" type="xsd:int" nillable="true"/>
          <xsd:element name="allAvailableSeats" type="tns:availableSeats" nillable="true"/>
          <xsd:element name="availableMaleCoupes" type="tns:availableSeats" nillable="true"/>
          <xsd:element name="availableFemaleCoupes" type="tns:availableSeats" nillable="true"/>
          <xsd:element name="availableMixedCoupes" type="tns:availableSeats" nillable="true"/>
          <xsd:element name="availableWholeCoupes" type="tns:availableSeats" nillable="true"/>
          <xsd:element name="seatMap" type="xsd:string" nillable="true"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="cars">
        <xsd:sequence>
          <xsd:element name="car" type="tns:car" minOccurs="0" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
      <xsd:complexType name="carSeatSearchResponse">
        <xsd:all>
          <xsd:element name="cars" type="tns:cars"/>
        </xsd:all>
      </xsd:complexType>
      <xsd:complexType name="getBalanceResponse">
        <xsd:all>
          <xsd:element name="bookingAllowed" type="xsd:boolean"/>
          <xsd:element name="creditLimit" type="xsd:float"/>
          <xsd:element name="availableCredit" type="xsd:float"/>
          <xsd:element name="paymentBalance" type="xsd:float"/>
          <xsd:element name="debts" type="xsd:float"/>
          <xsd:element name="currencyCode" type="xsd:string"/>
        </xsd:all>
      </xsd:complexType>
    </xsd:schema>
  </types>
  <message name="acr_JourneySearchRequest">
    <part name="access" type="tns:access"/>
    <part name="originDestinationSearch" type="tns:originDestinationSearch"/>
    <part name="roundtripOriginDestinationSearch" type="tns:inboundOriginDestinationSearch"/>
    <part name="passengers" type="tns:passengers"/>
  </message>
  <message name="acr_JourneySearchResponse">
    <part name="return" type="tns:journeySearchResponse"/>
  </message>
  <message name="acr_FareOfferSearchRequest">
    <part name="access" type="tns:access"/>
    <part name="journeyId" type="xsd:int"/>
    <part name="roundtripJourneyId" type="xsd:int"/>
  </message>
  <message name="acr_FareOfferSearchResponse">
    <part name="return" type="tns:fareOfferSearchResponse"/>
  </message>
  <message name="acr_GetJourneyRouteRequest">
    <part name="access" type="tns:access"/>
    <part name="journeyId" type="xsd:int"/>
  </message>
  <message name="acr_GetJourneyRouteResponse">
    <part name="return" type="tns:getJourneyRouteResponse"/>
  </message>
  <message name="acr_PreBookingRequest">
    <part name="access" type="tns:access"/>
    <part name="fareOfferId" type="xsd:int"/>
    <part name="roundtripFareOfferId" type="xsd:int"/>
    <part name="bookingRequest" type="tns:bookingRequest"/>
    <part name="roundtripBookingRequest" type="tns:bookingRequest"/>
    <part name="passengers" type="tns:passengers"/>
    <part name="contactDetails" type="tns:contactDetails"/>
  </message>
  <message name="acr_PreBookingResponse">
    <part name="return" type="tns:preBookingResponse"/>
  </message>
  <message name="acr_BookingRequest">
    <part name="access" type="tns:access"/>
    <part name="bookingId" type="xsd:int"/>
    <part name="creditCard" type="tns:creditCard"/>
  </message>
  <message name="acr_BookingResponse">
    <part name="return" type="tns:bookingResponse"/>
  </message>
  <message name="acr_GetBookingRequest">
    <part name="access" type="tns:access"/>
    <part name="bookingId" type="xsd:int"/>
  </message>
  <message name="acr_GetBookingResponse">
    <part name="return" type="tns:getBookingResponse"/>
  </message>
  <message name="acr_PreRefundRequest">
    <part name="access" type="tns:access"/>
    <part name="bookingId" type="xsd:int"/>
  </message>
  <message name="acr_PreRefundResponse">
    <part name="return" type="tns:preRefundResponse"/>
  </message>
  <message name="acr_RefundRequest">
    <part name="access" type="tns:access"/>
    <part name="refundId" type="xsd:int"/>
  </message>
  <message name="acr_RefundResponse">
    <part name="return" type="tns:refundResponse"/>
  </message>
  <message name="acr_GetRefundRequest">
    <part name="access" type="tns:access"/>
    <part name="refundId" type="xsd:int"/>
  </message>
  <message name="acr_GetRefundResponse">
    <part name="return" type="tns:getRefundResponse"/>
  </message>
  <message name="acr_GetCouponsRequest">
    <part name="access" type="tns:access"/>
    <part name="coupons" type="tns:coupons"/>
  </message>
  <message name="acr_GetCouponsResponse">
    <part name="return" type="tns:getCouponsResponse"/>
  </message>
  <message name="acr_CancelRequest">
    <part name="access" type="tns:access"/>
    <part name="bookingId" type="xsd:int"/>
  </message>
  <message name="acr_CancelResponse">
    <part name="return" type="tns:cancelResponse"/>
  </message>
  <message name="acr_GetBookingsListRequest">
    <part name="access" type="tns:access"/>
    <part name="dateFrom" type="xsd:date"/>
    <part name="dateTo" type="xsd:date"/>
  </message>
  <message name="acr_GetBookingsListResponse">
    <part name="return" type="tns:getBookingsListResponse"/>
  </message>
  <message name="acr_CarSeatSearchRequest">
    <part name="access" type="tns:access"/>
    <part name="fareOfferId" type="xsd:int"/>
  </message>
  <message name="acr_CarSeatSearchResponse">
    <part name="return" type="tns:carSeatSearchResponse"/>
  </message>
  <message name="acr_GetBalanceRequest">
    <part name="access" type="tns:access"/>
  </message>
  <message name="acr_GetBalanceResponse">
    <part name="return" type="tns:getBalanceResponse"/>
  </message>
  <service name="SoapApiService">
    <port name="SoapApiPort" binding="tns:SoapApiBinding">
      <soap:address location="https://dev.amr.local/app_dev.php/ws/SoapApi"/>
    </port>
  </service>
  <binding name="SoapApiBinding" type="tns:SoapApiPortType">
    <soap:binding transport="http://schemas.xmlsoap.org/soap/http" style="rpc"/>
    <operation name="acr_JourneySearch">
      <soap:operation soapAction="https://acr.localhost/ws/SoapApi/0.1/acr_JourneySearch"/>
      <input>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
    <operation name="acr_FareOfferSearch">
      <soap:operation soapAction="https://acr.localhost/ws/SoapApi/0.1/acr_FareOfferSearch"/>
      <input>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
    <operation name="acr_GetJourneyRoute">
      <soap:operation soapAction="https://acr.localhost/ws/SoapApi/0.1/acr_GetJourneyRoute"/>
      <input>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
    <operation name="acr_PreBooking">
      <soap:operation soapAction="https://acr.localhost/ws/SoapApi/0.1/acr_PreBooking"/>
      <input>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
    <operation name="acr_Booking">
      <soap:operation soapAction="https://acr.localhost/ws/SoapApi/0.1/acr_Booking"/>
      <input>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
    <operation name="acr_GetBooking">
      <soap:operation soapAction="https://acr.localhost/ws/SoapApi/0.1/acr_GetBooking"/>
      <input>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
    <operation name="acr_PreRefund">
      <soap:operation soapAction="https://acr.localhost/ws/SoapApi/0.1/acr_PreRefund"/>
      <input>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
    <operation name="acr_Refund">
      <soap:operation soapAction="https://acr.localhost/ws/SoapApi/0.1/acr_Refund"/>
      <input>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
    <operation name="acr_GetRefund">
      <soap:operation soapAction="https://acr.localhost/ws/SoapApi/0.1/acr_GetRefund"/>
      <input>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
    <operation name="acr_GetCoupons">
      <soap:operation soapAction="https://acr.localhost/ws/SoapApi/0.1/acr_GetCoupons"/>
      <input>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
    <operation name="acr_Cancel">
      <soap:operation soapAction="https://acr.localhost/ws/SoapApi/0.1/acr_Cancel"/>
      <input>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
    <operation name="acr_GetBookingsList">
      <soap:operation soapAction="https://acr.localhost/ws/SoapApi/0.1/acr_GetBookingsList"/>
      <input>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
    <operation name="acr_CarSeatSearch">
      <soap:operation soapAction="https://acr.localhost/ws/SoapApi/0.1/acr_CarSeatSearch"/>
      <input>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
    <operation name="acr_GetBalance">
      <soap:operation soapAction="https://acr.localhost/ws/SoapApi/0.1/acr_GetBalance"/>
      <input>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="literal" namespace="https://acr.localhost/ws/SoapApi/0.1/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
  </binding>
</definitions>]]></con:content><con:type>http://schemas.xmlsoap.org/wsdl/</con:type></con:part></con:definitionCache><con:endpoints><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint></con:endpoints><con:operation id="97001ad4-0b5d-4aa6-9755-2216fee76fce" isOneWay="false" action="https://acr.localhost/ws/SoapApi/0.1/acr_Booking" name="acr_Booking" bindingOperationName="acr_Booking" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="c9cb3918-75d5-4cc6-ab53-6325b84a0fff" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <ns:acr_Booking>\r
         <access>\r
            <!--You may enter the following 4 items in any order-->\r
            <resellerCode>?</resellerCode>\r
            <userName>?</userName>\r
            <password>?</password>\r
            <lang>?</lang>\r
         </access>\r
         <bookingId>?</bookingId>\r
         <creditCard>\r
            <!--You may enter the following 8 items in any order-->\r
            <cardholderName>?</cardholderName>\r
            <cardType>?</cardType>\r
            <cardNumber>?</cardNumber>\r
            <cvv>?</cvv>\r
            <expiryDate>?</expiryDate>\r
            <addressLine>?</addressLine>\r
            <postcode>?</postcode>\r
            <country>?</country>\r
         </creditCard>\r
      </ns:acr_Booking>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="https://acr.localhost/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:call></con:operation><con:operation id="79d14b18-24f5-4c1e-8009-23fb046aa5a3" isOneWay="false" action="https://acr.localhost/ws/SoapApi/0.1/acr_Cancel" name="acr_Cancel" bindingOperationName="acr_Cancel" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="22ef4286-7cf3-4cd0-b446-35c7d81fe056" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <ns:acr_Cancel>\r
         <access>\r
            <!--You may enter the following 4 items in any order-->\r
            <resellerCode>?</resellerCode>\r
            <userName>?</userName>\r
            <password>?</password>\r
            <lang>?</lang>\r
         </access>\r
         <bookingId>?</bookingId>\r
      </ns:acr_Cancel>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="https://acr.localhost/ws/SoapApi/0.1/acr_Cancel"/><con:wsrmConfig version="1.2"/></con:call></con:operation><con:operation id="7ebb7015-78a3-4883-bd95-abc5f45436eb" isOneWay="false" action="https://acr.localhost/ws/SoapApi/0.1/acr_CarSeatSearch" name="acr_CarSeatSearch" bindingOperationName="acr_CarSeatSearch" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="dd84b4f4-1b92-4b84-a356-70b9845caf3c" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <ns:acr_CarSeatSearch>\r
         <access>\r
            <!--You may enter the following 4 items in any order-->\r
            <resellerCode>?</resellerCode>\r
            <userName>?</userName>\r
            <password>?</password>\r
            <lang>?</lang>\r
         </access>\r
         <fareOfferId>?</fareOfferId>\r
      </ns:acr_CarSeatSearch>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="https://acr.localhost/ws/SoapApi/0.1/acr_CarSeatSearch"/></con:call></con:operation><con:operation id="cd26166d-45f5-4431-8b31-6da10a2c54b0" isOneWay="false" action="https://acr.localhost/ws/SoapApi/0.1/acr_FareOfferSearch" name="acr_FareOfferSearch" bindingOperationName="acr_FareOfferSearch" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="2f2f72c2-bc5d-4b66-a0e2-1bd4d3833ca7" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <ns:acr_FareOfferSearch>\r
         <access>\r
            <!--You may enter the following 4 items in any order-->\r
            <resellerCode>?</resellerCode>\r
            <userName>?</userName>\r
            <password>?</password>\r
            <lang>?</lang>\r
         </access>\r
         <journeyId>?</journeyId>\r
         <roundtripJourneyId>?</roundtripJourneyId>\r
      </ns:acr_FareOfferSearch>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="https://acr.localhost/ws/SoapApi/0.1/acr_FareOfferSearch"/></con:call></con:operation><con:operation id="3983ddcc-9ef9-4ae0-8fd4-8ba278394f19" isOneWay="false" action="https://acr.localhost/ws/SoapApi/0.1/acr_GetBalance" name="acr_GetBalance" bindingOperationName="acr_GetBalance" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="dbf72320-d23e-46cb-9d21-950797a9ee7e" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <ns:acr_GetBalance>\r
         <access>\r
            <!--You may enter the following 4 items in any order-->\r
            <resellerCode>?</resellerCode>\r
            <userName>?</userName>\r
            <password>?</password>\r
            <lang>?</lang>\r
         </access>\r
      </ns:acr_GetBalance>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="https://acr.localhost/ws/SoapApi/0.1/acr_GetBalance"/></con:call></con:operation><con:operation id="a12036fb-da88-400c-a5eb-b6160f652f20" isOneWay="false" action="https://acr.localhost/ws/SoapApi/0.1/acr_GetBooking" name="acr_GetBooking" bindingOperationName="acr_GetBooking" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="cf61bc2b-7f20-4ef7-b2d6-eea9f3813833" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <ns:acr_GetBooking>\r
         <access>\r
            <!--You may enter the following 4 items in any order-->\r
            <resellerCode>?</resellerCode>\r
            <userName>?</userName>\r
            <password>?</password>\r
            <lang>?</lang>\r
         </access>\r
         <bookingId>?</bookingId>\r
      </ns:acr_GetBooking>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="https://acr.localhost/ws/SoapApi/0.1/acr_GetBooking"/></con:call></con:operation><con:operation id="777d5b58-33a4-402c-96ae-befd94ce5590" isOneWay="false" action="https://acr.localhost/ws/SoapApi/0.1/acr_GetBookingsList" name="acr_GetBookingsList" bindingOperationName="acr_GetBookingsList" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="0790f1d0-bf4a-4eb9-91bc-ed28fc5390d3" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <ns:acr_GetBookingsList>\r
         <access>\r
            <!--You may enter the following 4 items in any order-->\r
            <resellerCode>?</resellerCode>\r
            <userName>?</userName>\r
            <password>?</password>\r
            <lang>?</lang>\r
         </access>\r
         <dateFrom>?</dateFrom>\r
         <dateTo>?</dateTo>\r
      </ns:acr_GetBookingsList>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="https://acr.localhost/ws/SoapApi/0.1/acr_GetBookingsList"/></con:call></con:operation><con:operation id="d7015663-7d2e-4bf9-ba0c-6a9a515c5257" isOneWay="false" action="https://acr.localhost/ws/SoapApi/0.1/acr_GetCoupons" name="acr_GetCoupons" bindingOperationName="acr_GetCoupons" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="fe188b63-6fcc-4219-b302-917e774d307b" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <ns:acr_GetCoupons>\r
         <access>\r
            <!--You may enter the following 4 items in any order-->\r
            <resellerCode>?</resellerCode>\r
            <userName>?</userName>\r
            <password>?</password>\r
            <lang>?</lang>\r
         </access>\r
         <coupons>\r
            <!--Zero or more repetitions:-->\r
            <coupon>\r
               <!--You may enter the following 2 items in any order-->\r
               <couponId>?</couponId>\r
               <couponPdf>?</couponPdf>\r
            </coupon>\r
         </coupons>\r
      </ns:acr_GetCoupons>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="https://acr.localhost/ws/SoapApi/0.1/acr_GetCoupons"/></con:call></con:operation><con:operation id="57384e11-360b-41e3-acb4-598328a20254" isOneWay="false" action="https://acr.localhost/ws/SoapApi/0.1/acr_GetJourneyRoute" name="acr_GetJourneyRoute" bindingOperationName="acr_GetJourneyRoute" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="ce08538d-5eed-47dc-8619-846d21c6c530" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <ns:acr_GetJourneyRoute>\r
         <access>\r
            <!--You may enter the following 4 items in any order-->\r
            <resellerCode>?</resellerCode>\r
            <userName>?</userName>\r
            <password>?</password>\r
            <lang>?</lang>\r
         </access>\r
         <journeyId>?</journeyId>\r
      </ns:acr_GetJourneyRoute>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="https://acr.localhost/ws/SoapApi/0.1/acr_GetJourneyRoute"/></con:call></con:operation><con:operation id="2d5098b3-e660-4c83-9bcd-e8ea3d3dd160" isOneWay="false" action="https://acr.localhost/ws/SoapApi/0.1/acr_GetRefund" name="acr_GetRefund" bindingOperationName="acr_GetRefund" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="39472bcd-cb61-4d4d-9bb4-5fbd7731dcb9" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <ns:acr_GetRefund>\r
         <access>\r
            <!--You may enter the following 4 items in any order-->\r
            <resellerCode>?</resellerCode>\r
            <userName>?</userName>\r
            <password>?</password>\r
            <lang>?</lang>\r
         </access>\r
         <refundId>?</refundId>\r
      </ns:acr_GetRefund>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="https://acr.localhost/ws/SoapApi/0.1/acr_GetRefund"/></con:call></con:operation><con:operation id="8f7a9f53-4619-4e8d-9fab-65a1bb6e6f62" isOneWay="false" action="https://acr.localhost/ws/SoapApi/0.1/acr_JourneySearch" name="acr_JourneySearch" bindingOperationName="acr_JourneySearch" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="72c3509a-8bac-46da-8322-fbcfaf1b4301" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <ns:acr_JourneySearch>\r
         <access>\r
            <!--You may enter the following 4 items in any order-->\r
            <resellerCode>?</resellerCode>\r
            <userName>?</userName>\r
            <password>?</password>\r
            <lang>?</lang>\r
         </access>\r
         <originDestinationSearch>\r
            <!--You may enter the following 5 items in any order-->\r
            <originCode>?</originCode>\r
            <originDate>?</originDate>\r
            <originTimeFrom>?</originTimeFrom>\r
            <originTimeTo>?</originTimeTo>\r
            <destinationCode>?</destinationCode>\r
         </originDestinationSearch>\r
         <roundtripOriginDestinationSearch>\r
            <!--You may enter the following 3 items in any order-->\r
            <originDate>?</originDate>\r
            <originTimeFrom>?</originTimeFrom>\r
            <originTimeTo>?</originTimeTo>\r
         </roundtripOriginDestinationSearch>\r
         <passengers>\r
            <!--1 to 9 repetitions:-->\r
            <passenger>\r
               <!--You may enter the following 14 items in any order-->\r
               <passengerId>?</passengerId>\r
               <salutation>?</salutation>\r
               <name>?</name>\r
               <surname>?</surname>\r
               <patronymic>?</patronymic>\r
               <documentType>?</documentType>\r
               <documentNumber>?</documentNumber>\r
               <documentExpireDate>?</documentExpireDate>\r
               <birthDate>?</birthDate>\r
               <nationality>?</nationality>\r
               <residence>?</residence>\r
               <email>?</email>\r
               <card>?</card>\r
               <additionalOptions>\r
                  <!--You may enter the following 2 items in any order-->\r
                  <luggageOptions>?</luggageOptions>\r
                  <seatNumbers>?</seatNumbers>\r
               </additionalOptions>\r
            </passenger>\r
         </passengers>\r
      </ns:acr_JourneySearch>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="https://acr.localhost/ws/SoapApi/0.1/acr_JourneySearch"/></con:call></con:operation><con:operation id="56de393a-f868-4288-a8cc-91460b8cb4c6" isOneWay="false" action="https://acr.localhost/ws/SoapApi/0.1/acr_PreBooking" name="acr_PreBooking" bindingOperationName="acr_PreBooking" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="2b3259d1-e812-4e6b-9cad-cd44e02bae88" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <ns:acr_PreBooking>\r
         <access>\r
            <!--You may enter the following 4 items in any order-->\r
            <resellerCode>?</resellerCode>\r
            <userName>?</userName>\r
            <password>?</password>\r
            <lang>?</lang>\r
         </access>\r
         <fareOfferId>?</fareOfferId>\r
         <roundtripFareOfferId>?</roundtripFareOfferId>\r
         <bookingRequest>\r
            <!--You may enter the following 19 items in any order-->\r
            <ticketOption>?</ticketOption>\r
            <genderCoupe>?</genderCoupe>\r
            <diapasonSeatMin>?</diapasonSeatMin>\r
            <diapasonSeatMax>?</diapasonSeatMax>\r
            <oneCoupe>?</oneCoupe>\r
            <oneSection>?</oneSection>\r
            <noSideSleeper>?</noSideSleeper>\r
            <noLinen>?</noLinen>\r
            <lowerSleeper>?</lowerSleeper>\r
            <upperSleeper>?</upperSleeper>\r
            <childMinTariff>?</childMinTariff>\r
            <specialRequests>?</specialRequests>\r
            <possiblePositions>?</possiblePositions>\r
            <luggageOptions>?</luggageOptions>\r
            <remarks>\r
               <!--1 or more repetitions:-->\r
               <remark>\r
                  <!--You may enter the following 2 items in any order-->\r
                  <name>?</name>\r
                  <value>?</value>\r
               </remark>\r
            </remarks>\r
            <paymentType>?</paymentType>\r
            <car>?</car>\r
            <seats>?</seats>\r
            <meals>?</meals>\r
         </bookingRequest>\r
         <roundtripBookingRequest>\r
            <!--You may enter the following 19 items in any order-->\r
            <ticketOption>?</ticketOption>\r
            <genderCoupe>?</genderCoupe>\r
            <diapasonSeatMin>?</diapasonSeatMin>\r
            <diapasonSeatMax>?</diapasonSeatMax>\r
            <oneCoupe>?</oneCoupe>\r
            <oneSection>?</oneSection>\r
            <noSideSleeper>?</noSideSleeper>\r
            <noLinen>?</noLinen>\r
            <lowerSleeper>?</lowerSleeper>\r
            <upperSleeper>?</upperSleeper>\r
            <childMinTariff>?</childMinTariff>\r
            <specialRequests>?</specialRequests>\r
            <possiblePositions>?</possiblePositions>\r
            <luggageOptions>?</luggageOptions>\r
            <remarks>\r
               <!--1 or more repetitions:-->\r
               <remark>\r
                  <!--You may enter the following 2 items in any order-->\r
                  <name>?</name>\r
                  <value>?</value>\r
               </remark>\r
            </remarks>\r
            <paymentType>?</paymentType>\r
            <car>?</car>\r
            <seats>?</seats>\r
            <meals>?</meals>\r
         </roundtripBookingRequest>\r
         <passengers>\r
            <!--1 to 9 repetitions:-->\r
            <passenger>\r
               <!--You may enter the following 14 items in any order-->\r
               <passengerId>?</passengerId>\r
               <salutation>?</salutation>\r
               <name>?</name>\r
               <surname>?</surname>\r
               <patronymic>?</patronymic>\r
               <documentType>?</documentType>\r
               <documentNumber>?</documentNumber>\r
               <documentExpireDate>?</documentExpireDate>\r
               <birthDate>?</birthDate>\r
               <nationality>?</nationality>\r
               <residence>?</residence>\r
               <email>?</email>\r
               <card>?</card>\r
               <additionalOptions>\r
                  <!--You may enter the following 2 items in any order-->\r
                  <luggageOptions>?</luggageOptions>\r
                  <seatNumbers>?</seatNumbers>\r
               </additionalOptions>\r
            </passenger>\r
         </passengers>\r
         <contactDetails>\r
            <!--You may enter the following 15 items in any order-->\r
            <title>?</title>\r
            <name>?</name>\r
            <surname>?</surname>\r
            <flat>?</flat>\r
            <buildingName>?</buildingName>\r
            <buildingNumber>?</buildingNumber>\r
            <street>?</street>\r
            <city>?</city>\r
            <postcode>?</postcode>\r
            <country>?</country>\r
            <internationalCode>?</internationalCode>\r
            <areaCode>?</areaCode>\r
            <number>?</number>\r
            <extension>?</extension>\r
            <email>?</email>\r
         </contactDetails>\r
      </ns:acr_PreBooking>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="https://acr.localhost/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:call></con:operation><con:operation id="dd74a6df-8c1b-4f55-9392-970280b1028b" isOneWay="false" action="https://acr.localhost/ws/SoapApi/0.1/acr_PreRefund" name="acr_PreRefund" bindingOperationName="acr_PreRefund" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="00aacafb-2f78-49a2-b10b-4200376f6bb6" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <ns:acr_PreRefund>\r
         <access>\r
            <!--You may enter the following 4 items in any order-->\r
            <resellerCode>?</resellerCode>\r
            <userName>?</userName>\r
            <password>?</password>\r
            <lang>?</lang>\r
         </access>\r
         <bookingId>?</bookingId>\r
      </ns:acr_PreRefund>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="https://acr.localhost/ws/SoapApi/0.1/acr_PreRefund"/></con:call></con:operation><con:operation id="fac8bb64-d1ea-4005-82a2-da946f32634c" isOneWay="false" action="https://acr.localhost/ws/SoapApi/0.1/acr_Refund" name="acr_Refund" bindingOperationName="acr_Refund" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="bf196f2d-b8a8-4836-abae-e303c0e9437c" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <ns:acr_Refund>\r
         <access>\r
            <!--You may enter the following 4 items in any order-->\r
            <resellerCode>?</resellerCode>\r
            <userName>?</userName>\r
            <password>?</password>\r
            <lang>?</lang>\r
         </access>\r
         <refundId>?</refundId>\r
      </ns:acr_Refund>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="https://acr.localhost/ws/SoapApi/0.1/acr_Refund"/></con:call></con:operation></con:interface><con:testSuite id="14015895-6230-4a70-b3c5-4a52db01ab29" name="HEX" disabled="true"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="b4e8bc7f-3288-463f-bb43-c74722b651b7" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="LON-LHR booking" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="4bd74162-2437-444f-b33c-2a40a152f2d8"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="cb9ffcd3-5dc3-4f6e-b9ca-f19cce0e1d9c" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>LON</originCode>
            <originDate>${=(new Date()+15).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>LHR</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="e3debf37-d6d5-4f5f-b467-ec908b117a54"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="e92dcb81-fcd6-4c5d-8e86-8da1d9468129" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId/>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="Simple Contains" id="704663da-4d5f-4f53-aa62-392603d926cc" name="Contains"><con:configuration><token> &lt;fareRules>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="4143af68-d833-43ff-bfb7-f52441b4b589"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="6301482d-da81-46b6-9896-03682cf64ffa"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="802ac3f4-d896-474c-87f2-51a738c408ca" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>2610394</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="cac8a2d0-5f29-4085-874f-0b1011bbb3f6"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="80072c18-defa-442b-a3f7-e08f85b80ac4" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>9558</bookingId>
         <creditCard>
            <cardholderName>Mickey Mouse</cardholderName>
            <cardType>CA</cardType>
            <cardNumber>5453010000070151</cardNumber>
            <cvv>000</cvv>
            <expiryDate>11/19</expiryDate>
            <addressLine>Sikamore Lane 212</addressLine>
            <postcode>08900</postcode>
            <country>US</country>
         </creditCard>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="Simple Contains" id="7356ba5b-aa07-4338-babc-65e4551407be" name="Contains"><con:configuration><token> &lt;bookingId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="731a7deb-7102-473a-aa06-64b33713c56d" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="LHR-LON booking" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="6191cf23-cb04-49da-9dab-937cf4c24f8c"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="77d4d620-a758-48ef-9fbe-c2798c60ea03" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>LHR</originCode>
            <originDate>${=(new Date()+15).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>LON</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="6a2c189a-f61d-45c0-be52-e82424e04b04"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="5acaeae2-cac5-4ab8-a629-b697c9271968" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId/>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="1f8429b1-5a50-4966-9c72-1ae22e66694f"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="06942d60-a3c6-4979-9562-934e54ce216a"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="dcc37bb3-ecb4-4f41-9343-4daf7f09e5de" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId/>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="cf85369f-bba7-4894-905e-6a44f3def6e6"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="95d8a8d6-98eb-466a-9ac0-864c6cbfbc7e" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId/>
         <creditCard>
            <cardholderName>Mickey Mouse</cardholderName>
            <cardType>CA</cardType>
            <cardNumber>5453010000070151</cardNumber>
            <cvv>000</cvv>
            <expiryDate>11/19</expiryDate>
            <addressLine>Sikamore Lane 212</addressLine>
            <postcode>08900</postcode>
            <country>US</country>
         </creditCard>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="Simple Contains" id="2dd90b0a-f4e5-4aa1-80c5-785c6d01e456" name="Contains"><con:configuration><token>  &lt;bookingId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:properties/></con:testSuite><con:testSuite id="d06420ca-62c4-4e86-a4ba-a9bff38e38cb" name="RENFE ACR WS"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="e1e89f2f-dfe5-42bb-a3ef-ec12b6428004" failOnError="false" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Search All Countries (+RoundTrip)" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="properties" name="Properties of search" id="599fb796-6ded-4cea-961c-88f8a04a74b4"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>date of travel</con:name><con:value>${=(new Date()+3).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>ES2ES_Departure</con:name><con:value>7171801</con:value></con:property><con:property><con:name>ES2ES_Destination</con:name><con:value>7165410</con:value></con:property><con:property><con:name>date of return</con:name><con:value>${=(new Date()+4).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>ES2FR_Departure</con:name><con:value>7171801</con:value></con:property><con:property><con:name>ES2FR_Destination</con:name><con:value>8700013</con:value></con:property><con:property><con:name>PT2FR_Departure</con:name><con:value>9400999</con:value></con:property><con:property><con:name>PT2FR_Destination</con:name><con:value>8700293</con:value></con:property><con:property><con:name>PT2ES_Departure</con:name><con:value>9400999</con:value></con:property><con:property><con:name>PT2ES_Destination</con:name><con:value>7117000</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer ES-ES" id="afb16f6f-0377-425e-8510-9eeaebeeae65"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>Single ES-ES</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>ES2ES_Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Single ES-ES</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>ES2ES_Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Single ES-ES</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script: set endpoint" id="f1d8807e-7c2e-45e8-9e57-1fb8125830f2"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project


  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()

  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }</script></con:config></con:testStep><con:testStep type="request" id="fc0a9d6e-55a1-4f94-915b-f877f1b442bc" name="Single ES-ES"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Single ES-ES" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7171801</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7165410</destinationCode>
         </originDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer ES-ES Roundtrip" id="ab9b7fa6-81ad-480f-a30c-5497b60b02fe"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>Round ES-ES</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>ES2ES_Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Round ES-ES</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>ES2ES_Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Round ES-ES</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>returnDate</con:name><con:sourceType>date of return</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Round ES-ES</con:targetStep><con:targetPath>//roundtripOriginDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="4b003fc5-c8cb-40b9-a00b-db1db195b7ae" name="Round ES-ES"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Round ES-ES" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7171801</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7165410</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer ES-FR" id="9f2397cd-caf0-4c72-a6d8-2600dd3cb58e"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>Single ES-FR</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>ES2FR_Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Single ES-FR</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>ES2FR_Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Single ES-FR</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="92bc15e3-acbb-49a4-8486-0e64aeb73600" name="Single ES-FR"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Single ES-FR" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7171801</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>8700013</destinationCode>
         </originDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer ES-FR Roundtrip" id="3011f49d-1ca3-425b-83f6-efd339d857a6"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>Round ES-FR</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>ES2FR_Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Round ES-FR</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>ES2FR_Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Round ES-FR</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>returnDate</con:name><con:sourceType>date of return</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Round ES-FR</con:targetStep><con:targetPath>//roundtripOriginDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="1315bcd0-4765-4c1e-ba9a-472ab20e8d42" name="Round ES-FR"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Round ES-FR" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7171801</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>8700013</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer PT-FR" id="fe27930d-9fcc-4967-b60b-6af78b97c419"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>Single PT-FR</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>PT2FR_Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Single PT-FR</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>PT2FR_Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Single PT-FR</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="bfb445ea-e5b7-4cf5-82c0-197dc20df32b" name="Single PT-FR"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Single PT-FR" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>9400999</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>8700293</destinationCode>
         </originDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Transfer PT-FR Roundtrip" id="b1e6fba6-163f-419f-a079-b9c0235f909f"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>Round PT-FR</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>PT2FR_Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Round PT-FR</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>PT2FR_Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Round PT-FR</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>returnDate</con:name><con:sourceType>date of return</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Round PT-FR</con:targetStep><con:targetPath>//roundtripOriginDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="7d4c64c2-ef2c-45d5-9ab3-2e291ddf3959" name="Round PT-FR"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Round PT-FR" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>9400999</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>8700293</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer PT-ES" id="48d5c5e8-df98-482a-9a9e-66ca0bb3121f"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>Single PT-ES</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>PT2ES_Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Single PT-ES</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>PT2ES_Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Single PT-ES</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="939fb74c-f07b-4808-8b84-c20e85dde85b" name="Single PT-ES"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Single PT-ES" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>9400999</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7117000</destinationCode>
         </originDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Transfer PT-ES Roundtrip" id="34110f0b-3644-46cc-bc8c-d605e8b7cd73"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>Round PT-ES</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>PT2ES_Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Round PT-ES</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>PT2ES_Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Round PT-ES</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>returnDate</con:name><con:sourceType>date of return</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Round PT-ES</con:targetStep><con:targetPath>//roundtripOriginDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="3b503450-a7a6-448c-aaf2-f7adc42d58de" name="Round PT-ES"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Round PT-ES" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>9400999</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7117000</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="ce37de5f-7863-410d-9d80-237609b1750d" failOnError="false" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="SearchNEG" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="766fdf89-726f-4114-bd75-ed94573cf19d"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project


  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()

  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }</script></con:config></con:testStep><con:testStep type="request" id="0ca2ed53-86ce-4b1e-9f2f-eff54ee0175f" name="Departure point not set"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Departure point not set" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode/>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7165410</destinationCode>
         </originDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="e1f1c441-87dc-4806-ae55-ba47d608067c" name="Contains"><con:configuration><token>3704: Пункт отправления не определен.</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Not SOAP Fault Assertion" id="84f9a955-c6b6-43a4-8fb6-ae00b6dafd68" name="SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="1ebdaf68-07e5-4148-bca4-a5e7443640a9" name="Departure point invalid"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Departure point invalid" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ghj</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7165410</destinationCode>
         </originDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="e1f1c441-87dc-4806-ae55-ba47d608067c" name="Contains"><con:configuration><token>3704: Пункт отправления не определен.</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="287e9316-6ace-4808-b7a5-dfa1263bce96" name="Arrival point not set"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Arrival point not set" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>mad</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode/>
         </originDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="e1f1c441-87dc-4806-ae55-ba47d608067c" name="Contains"><con:configuration><token>3703: Пункт назначения не определен.</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="7da0788a-797b-498a-88ee-b14c6925f1db" name="RT  date back early then departure"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="RT  date back early then departure" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7171801</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7165410</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
           <originDate>${=(new Date()+2).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Not SOAP Fault Assertion" id="cd30db26-6e48-493f-ad49-4497e2c12eb5" name="SOAP Fault"/><con:assertion type="Simple Contains" id="5e5edea6-09e9-409c-b553-a6bdcf3f60b8" name="Contains"><con:configuration><token>>0: The outbound date could not exceed the inbound one</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="65e27d26-d1b7-4ff8-8459-c61bad8b295b" name="RT  passengers more 10"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="RT  passengers more 10" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7171801</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7165410</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
           <originDate>${=(new Date()+2).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               </passenger>
            <passenger>
               </passenger>
               <passenger>
               </passenger>
               <passenger>
               </passenger>
               <passenger>
               </passenger>
               <passenger>
               </passenger>
               <passenger>
               </passenger>
               <passenger>
               </passenger>
               <passenger>
               </passenger>
               <passenger>
               </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Not SOAP Fault Assertion" id="cd30db26-6e48-493f-ad49-4497e2c12eb5" name="SOAP Fault"/><con:assertion type="Simple Contains" id="5e5edea6-09e9-409c-b553-a6bdcf3f60b8" name="Contains"><con:configuration><token>3709: Превышено допустимое количество пассажиров</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="c79a957f-bbb1-4f86-98bd-4f091f5338ef" name="passengers birth from future"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="passengers birth from future" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7171801</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7165410</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
           <originDate>${=(new Date()+8).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>${=(new Date()+2).format('yyyy-MM-dd')}</birthDate>
               </passenger>
           
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Not SOAP Fault Assertion" id="cd30db26-6e48-493f-ad49-4497e2c12eb5" name="SOAP Fault"/><con:assertion type="Simple Contains" id="5e5edea6-09e9-409c-b553-a6bdcf3f60b8" name="Contains"><con:configuration><token>2428: Некорректная дата рождения.</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="1d65ddd8-9364-4d1d-9fc3-1f1f673c1f43" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="SearchNEGMandDate" searchProperties="true" disabled="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="5b8aae7a-0eb3-4235-b0b2-c4775ee7e5a4"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project


  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()

  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }</script></con:config></con:testStep><con:testStep type="request" id="e12836e6-cfbc-4789-8b2c-ce55147ccae3" name="RT mandatory date"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="RT mandatory date" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7171801</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7165410</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
           
		  <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Not SOAP Fault Assertion" id="cd30db26-6e48-493f-ad49-4497e2c12eb5" name="SOAP Fault"/><con:assertion type="Simple Contains" id="5e5edea6-09e9-409c-b553-a6bdcf3f60b8" name="Contains"><con:configuration><token>AMR-963</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="679ae5ca-0062-4e7e-8eee-b3a69f5e563d" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="PreBooking &amp; Cancel" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="10d5d4d6-5b92-4ea4-966f-411e220d9968"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project


  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()

  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }</script></con:config></con:testStep><con:testStep type="request" id="85888249-6245-4717-8486-d8acf5034404" name="Мадрид-Барселона"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Мадрид-Барселона" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7171801</originCode>
            <originDate>${=(new Date() +12).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>15:00</originTimeTo>
            <destinationCode>mad</destinationCode>
         </originDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
             
               <additionalOptions>
               </additionalOptions>
            </passenger>
          
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journeys/journey[1]/journeyId,"[0-9]{4}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0b018c51-583a-4ed4-8732-b07ef8db0a19" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyInfo[1]/departureName,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="8d182e08-482f-4d50-9318-8452f460f912" name="XPath Match 2"><con:configuration><path>matches(//journeys/journey[1]/journeyInfo[1]/arrivalName,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="c7034b1f-9a33-411a-978b-0bf519dddcc7" name="XPath Match 3"><con:configuration><path>matches(//journeys/journey[1]/journeySegments[1]/journeySegment/trainNumber,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="aa32da7c-1cbc-4039-9b13-7d2c4552deb5" name="Contains"><con:configuration><token>&lt;operatorName>RenFe&lt;/operatorName>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="88399269-f9f1-45a7-980c-5f6aa8e7bbb6" name="Contains 1"><con:configuration><token>&lt;trainCategory>AVE&lt;/trainCategory>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="7d457331-1ee5-4911-b2dc-ea49c7ba4f76"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>Мадрид-Барселона</con:sourceStep><con:sourcePath>//journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="5e06fc40-3b69-46a5-863b-59dabc3a10b5" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8403</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="XPath Match" id="e0a19b1f-9978-4296-b3a6-4f6773ca81ad" name="XPath Match"><con:configuration><path>matches(//fareOffers//fareOffer[1]/netFare,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="c99f212c-1d36-4483-9f95-5cd5c8845801" name="XPath Match 1"><con:configuration><path>matches(//fareOffers/fareOffer[1]/fareRules,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="ff5b527c-f4bf-461c-8873-897160aa9bdd" name="XPath Match 2"><con:configuration><path>matches(//fareOffers/fareOffer[1]/fareName,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="18003169-ff5b-4c30-aa60-307fb44c3956" name="XPath Match 3"><con:configuration><path>matches(//fareOffers/fareOffer[1]/serviceClass,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="46119d96-b503-4d02-8057-fac8d87ea922" name="XPath Match 4"><con:configuration><path>matches(//fareOffers/fareOffer[1]/ticketOptions/ticketOption,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="21fc7f89-e290-4969-80a4-4ff057ae6474"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="08a5ff51-af97-4fc1-b932-1679b2cd4e5a" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>66459</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <email>asd@ad.da</email>
               <birthDate>1990-01-01</birthDate>
            </passenger>
         </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="ac5c115e-d8cb-4051-87c1-2808309f5fbb" name="Contains"><con:configuration><token>&lt;status>PR&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="XPath Match" id="49288c9f-3c49-4837-b043-bb4904478d06" name="XPath Match"><con:configuration><path>matches(//seats/seat/ticketId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="5f72cc50-a190-4f34-9615-90a27a1dda0f" name="XPath Match 1"><con:configuration><path>matches(//seats/seat/placeNumber,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="df323edb-f29c-4fa5-8526-773d87f309d2" name="XPath Match 2"><con:configuration><path>matches(//seats/seat/carNumber,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="d1ad5310-93fc-4999-81c4-037519357588" name="XPath Match 3"><con:configuration><path>matches(//fares/fare[1]/netFare,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="505d7c38-c375-4215-a0ab-295b0a796223"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Cancel</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="dbad0a09-707e-4425-91d4-15feaff03c96" name="acr_Cancel"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Cancel</con:operation><con:request name="acr_Cancel" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="6da5987b-4b1a-4ef6-8304-05b3970c49dd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Cancel>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>261</bookingId>
      </ns:acr_Cancel>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="9bbcb2b2-2b38-41b9-a386-97ac496fcdeb" name="SOAP Response"/><con:assertion type="XPath Match" id="52cc9f32-e216-420b-9d5f-5bbf65eb8dae" name="XPath Match"><con:configuration><path>matches(//booking/status, "XX")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Cancel"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="0b36a523-37c4-4ce4-a88f-6194511d916a" failOnError="false" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="5d5acf1c-bc77-410f-85fd-78b017c29dfb"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="7911ccb5-4b95-4913-b2b4-37195eb0ec0f" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7110600</originCode>
            <originDate>${=(new Date()+10).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7114100</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="aa5887c8-ccec-482b-9c5b-0898b5f5e14b"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="985ed124-2a85-4a2a-9362-bb3615d4f655" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8480</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="995034a2-afe9-430f-9820-da629e061d29"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="a3bf06ef-5a67-468f-8ef5-e498dba2689a"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId1</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBookingNEG_changePassCount</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId2</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBookingNEG_changePassBirthDate</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId3</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBookingNEG_NoSalutation</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId4</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking_nearWindow</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId5</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking_nearPass</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId6</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking_withoutWindow</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="c7cd55bb-df01-45c7-9419-736e46c8481a" name="acr_PreBookingNEG_changePassCount"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBookingNEG_changePassCount" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>67183</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="cd530d02-b050-426d-bf9d-ef9b54219a61" name="Contains"><con:configuration><token>3603: Введены некорректные данные.</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="a45ceb90-3ed7-4544-af84-df0e5c4560de" name="acr_PreBookingNEG_changePassBirthDate"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBookingNEG_changePassBirthDate" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>67183</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1991-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
           
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="cd530d02-b050-426d-bf9d-ef9b54219a61" name="Contains"><con:configuration><token>3711: Даты рождения должны совпадать с датами рождения, введенными для поиска.</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="deea7661-130b-402f-ad11-7a5fae12002b" name="acr_PreBookingNEG_NoSalutation"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBookingNEG_NoSalutation" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>67183</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
           
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="cd530d02-b050-426d-bf9d-ef9b54219a61" name="Contains"><con:configuration><token>2403: Некорректное обращение к пассажиру.</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="6d13f118-a632-430d-a5b8-c5119f9bed6c" name="acr_PreBooking_nearWindow"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking_nearWindow" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>67183</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
            <possiblePositions>window</possiblePositions>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="7a2e8418-612d-4f4d-aef1-3fc8bf05ff2f" name="acr_PreBooking_nearPass"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking_nearPass" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>67183</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
            <possiblePositions>aisle</possiblePositions>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="43a6b275-4c02-4c44-abac-8208f6f6099b" name="acr_PreBooking_withoutWindow"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking_withoutWindow" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>67183</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
            <possiblePositions>window_isolated</possiblePositions>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="b3cb6786-a870-4a94-be8c-4af936f3febc" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>67183</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="693f0731-c30b-4e84-8120-f689230859aa"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="a9a22900-e95c-4ac0-bbb3-141f0405c0ec" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>265</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="46c57023-d782-4d4b-ba8e-c18da655755a" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking &amp; Anulation" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="03a10495-cba5-4aef-af99-05a0e293117c"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="74a9cd30-676a-445e-aa9e-ef6c2922656c" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7110600</originCode>
            <originDate>${=(new Date()+1).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7114100</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1930-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1960-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1910-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="e2569f75-bc39-4ce6-b0a4-84c047b86bbb"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="7ed1dc52-2b2c-4b10-8a81-5d077955b39d" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8558</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="48a0f521-a21e-48ce-9044-0df62944ffbb"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="b1a78a92-8c1f-438a-905d-b6bb1a8ba763"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="62bd0f0e-29a1-43d1-acf7-1163502bb8c1" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>67717</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>2</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameThird</name>
               <surname>TestSurnameThird</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>3</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameFourth</name>
               <surname>TestSurnameFourth</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>4</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameFifth</name>
               <surname>TestSurnameFifth</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>5</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSixst</name>
               <surname>TestSurnameSixst</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1930-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>6</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSeventh</name>
               <surname>TestSurnameSeventh</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>7</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameEight</name>
               <surname>TestSurnameEight</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1960-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>8</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameNine</name>
               <surname>TestSurnameNine</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1910-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="45a2b0d5-761f-4b65-b0f2-6eb10eb0bd6b"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="917fb138-a713-4900-98b5-6283e56f4935" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>266</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer: bookingId" id="be051414-7db5-42b6-9dbe-6b6a09bb6558"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Booking</con:sourceStep><con:sourcePath>//bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Cancel</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="804245ac-d0fb-4b71-85f9-c6de17955ec4" name="acr_Cancel"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Cancel</con:operation><con:request name="acr_Cancel" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="6da5987b-4b1a-4ef6-8304-05b3970c49dd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Cancel>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>266</bookingId>
      </ns:acr_Cancel>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="9bbcb2b2-2b38-41b9-a386-97ac496fcdeb" name="SOAP Response"/><con:assertion type="XPath Match" id="52cc9f32-e216-420b-9d5f-5bbf65eb8dae" name="XPath Match"><con:configuration><path>matches(//booking/status, "XX")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Cancel"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="5dcbc567-7318-459f-934b-04282f859690" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking ChildFree+Adult" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="2be1375e-09d1-4762-9853-508af9360257"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="db06ad77-12ba-4a8c-adf5-9572ab8056b3" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7110600</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7114100</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>2015-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="c1553d45-ef12-4a02-91f0-42e34424a0af"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="f5a13769-8298-46c7-b8af-52018f81886f" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8601</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="a5a45833-68b2-4db9-b286-c9d880e28a87"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="1a014cc9-c46f-4320-bcbe-8a2c446d3d13"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="232361e4-e634-41b1-9431-2cbb1d1dd2b0" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>68040</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
         <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2015-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
                 
            </passenger>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameTwo</name>
               <surname>TestSurnameTwo</surname>
               <patronymic>Testtwo</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234568</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>       
                       
            </passenger>
            
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="f48987a9-1b5a-40ae-8389-53bcd7f6b835"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="398cb0d3-272b-4a33-a613-a65f79e82d48" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>267</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="69a23816-b459-4418-b308-ce60dab9a6a9" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking Adult+TwoChildFree" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="35780133-1ce7-4917-8291-39f20ee7bb86"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="b226306e-f208-412f-9e18-0c751f9b1d58" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7110600</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7114100</destinationCode>
         </originDestinationSearch>
         <passengers>
          
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
              <passenger>
               <birthDate>2015-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
              <passenger>
               <birthDate>2015-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="c2c53bcc-7ae0-41a9-a6c5-9bc71ba33cc6"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="47d87dad-0ef1-4bf0-8817-a31afe27edbe" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8627</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="45ce53f1-e211-4be9-8115-e74195912096"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="0bbb1b2e-e07c-429e-b010-ddf68fe09141"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="3527643c-9e50-482e-b134-0c6890580180" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>68104</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
         <passenger>
             
           
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
             <passenger>
              <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameTwo</name>
               <surname>TestSurnameTwo</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2015-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
             <passenger>
              <passengerId>2</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameThree</name>
               <surname>TestSurnameThree</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2015-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="094a9ed5-6e9c-4d61-931b-2276a040a58a" name="Contains"><con:configuration><token>0: Количество мест с полным тарифом должно быть не меньше, чем количество детей без места</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="51ef1243-aeb2-4ef3-842b-24305137ade8" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking 2Adult+Child+ChildFree" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="36c31652-130e-457b-af58-f79e271381cd"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="604a4c3c-8d22-4b22-80ac-6062649c7fb3" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>mad</originCode>
            <originDate>${=(new Date()+2).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>bcn</destinationCode>
         </originDestinationSearch>
         <passengers>
          
             <passenger>
               
            </passenger>
           
              <passenger>
               <birthDate>2008-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
              <passenger>
               <birthDate>2015-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="44a09a14-07c7-4920-9120-a231a7fcc259"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="0e41d4a3-b4e8-4d89-9e6f-ce6e760032b1" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8683</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="ae0d2ca3-d3c2-471b-ad0e-81a9a5e4e603"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="cb24a9ef-5883-4d07-9a9e-5f29f276d6a3"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="a081a985-6456-4a4f-abea-8fe9dafa85e6" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>68353</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
         <passenger>
                     
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
           
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
             <passenger>
              <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2008-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
              <passengerId>2</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2015-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
             <passengerId>3</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="441aa1cf-fbac-43b6-a68f-4d1bd9e14066" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="2aed626e-d1d9-4353-a573-e59f023651bb"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="11b095be-ddb6-4b25-b4f3-5df0ee87715c" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>268</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="23bcd57f-355c-4f4b-ac42-917a0591de3a" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking &amp; Refund" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="a68f52d5-b88e-4852-869a-2c42f96763a1"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="f7557155-151b-4bf6-9b04-5f9f1d07c3a3" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7110600</originCode>
            <originDate>${=(new Date()+10).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7114100</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="c714ab84-f0e5-4570-92de-72d670e28088"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"] and journeyInfo/ticketOptions[ticketOption="ETK"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="8660063a-37f1-4b18-b58c-546ac9c58012" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8716</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="095300f4-0862-4568-9035-38b265d00a51"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="db46a0d7-6b30-4d78-906a-3845e06a1904"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="30e86bf4-c167-494d-ac46-a13afef47f33" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>68436</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="61f22caa-6138-4e91-bc75-065126073c0e"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="c55acd2c-108f-43f3-95ea-3dd7d05d8c31" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>269</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: bookingId" id="f4252835-9bf0-4b34-aaa0-82beb2ee5909"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Booking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreRefund</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="delay" name="Delay 1" id="54bed314-f1d9-41cc-b4c6-4017044d34f2"><con:settings/><con:config><delay>3000</delay></con:config></con:testStep><con:testStep type="request" id="2ca86eca-7279-4702-ad6f-c2fd31ca5d97" name="acr_PreRefund"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreRefund</con:operation><con:request name="acr_PreRefund" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="3a17447d-e3f8-4d8a-af58-d05663d91db0"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreRefund>
        <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>269</bookingId>
      </ns:acr_PreRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="c792ccd7-6460-4db6-9881-5ac3877082ab" name="SOAP Response"/><con:assertion type="Simple Contains" id="f4f6dc35-7e24-4067-abf1-2d9d797e8627" name="Contains"><con:configuration><token>&lt;status>LO&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="XPath Match" id="db94a3cb-d093-4d05-9f51-fbbdfadb07b4" name="XPath Match"><con:configuration><path>matches(//refundTickets/refundTicket[1]/refundId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreRefund"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: refundId" id="80e0d09f-a939-4acb-8bbd-dacda307e1c5"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreRefund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Refund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="304ebd92-1a56-4c29-a361-8408a2f39ea7" name="acr_Refund"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Refund</con:operation><con:request name="acr_Refund" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="d53948c5-ac6f-4069-bdea-41ea51b4508e"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Refund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>81</refundId>
      </ns:acr_Refund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5721d579-08d7-4bbf-a04f-ebdeea6920d3" name="SOAP Response"/><con:assertion type="XPath Match" id="27f4b24d-d4e9-447f-9c38-9ff648199ab0" name="XPath Match"><con:configuration><path>matches(//return/refund/status, "OK")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Refund"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 3: refundId" id="880cc507-6800-4314-aade-8208712f6c19"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Refund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetRefund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="488d98e8-fca4-4fdc-a81b-77292efef952" name="acr_GetRefund"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetRefund</con:operation><con:request name="acr_GetRefund" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="276edeeb-383f-44e6-9957-d8e9372e72d6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>81</refundId>
      </ns:acr_GetRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="16f0d6f2-40e4-4c5d-83ab-42a327488cc7" name="SOAP Response"/><con:assertion type="XPath Match" id="c94185e3-f986-436e-8e25-cc3cd0a0a7e4" name="XPath Match"><con:configuration><path>matches(//return/refund/status, "OK")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_GetRefund"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="010c89e7-b1a8-463e-b38d-07a5dceb57c2" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking &amp; Refund_Adult+Child" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="db7ca4aa-5c47-4be6-88a2-e09df2093505"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="6f1092b7-c8b4-4210-9f04-41028ff3a3d8" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>MAD</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>BCN</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>2010-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="e0b0346a-b003-47f8-8278-1f3633168950"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"] and journeyInfo/ticketOptions[ticketOption="ETK"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="2d436734-30e7-4b41-8bf0-373df4a8a5bb" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8748</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="Simple Contains" id="9adfa51e-7953-4b6a-85d8-73656969c7a5" name="Contains"><con:configuration><token>&lt;fareName>FLEXIBLE, Nino&lt;/fareName>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="b99a01b4-d276-4aea-8aac-43df8432890f"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="94d864a0-e93f-4ee0-b45b-d4c9f2854274"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="30ed45e9-5f36-42c5-ab26-0d64990c12bc" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>68596</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2010-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="8beca259-b0fc-436f-b3da-563cd015714f"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="860297c3-e1dc-4387-af66-1c72171ca11a" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>271</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: bookingId" id="cf144e1e-758d-43c3-862b-c6c907b8e617"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Booking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreRefund</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="delay" name="Delay 1" id="3d65712c-e2dd-44b7-baef-474117a37ac7"><con:settings/><con:config><delay>3000</delay></con:config></con:testStep><con:testStep type="request" id="89380c61-e644-4968-ad85-246583d1807b" name="acr_PreRefund"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreRefund</con:operation><con:request name="acr_PreRefund" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="3a17447d-e3f8-4d8a-af58-d05663d91db0"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreRefund>
        <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>271</bookingId>
      </ns:acr_PreRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="c792ccd7-6460-4db6-9881-5ac3877082ab" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreRefund"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: refundId" id="dd91147b-5278-4f1c-b44a-22334a7b179d"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreRefund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Refund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="989f6f59-1709-4f36-b2e1-91bb1898f057" name="acr_Refund"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Refund</con:operation><con:request name="acr_Refund" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="d53948c5-ac6f-4069-bdea-41ea51b4508e"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Refund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>82</refundId>
      </ns:acr_Refund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5721d579-08d7-4bbf-a04f-ebdeea6920d3" name="SOAP Response"/><con:assertion type="XPath Match" id="27f4b24d-d4e9-447f-9c38-9ff648199ab0" name="XPath Match"><con:configuration><path>matches(//return/refund/status, "OK")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Refund"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 3: refundId" id="ea6ff8d6-17ab-4e65-adb2-6664f2adceed"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Refund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetRefund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="d9adc32d-b53d-4996-9633-49bb744554d3" name="acr_GetRefund"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetRefund</con:operation><con:request name="acr_GetRefund" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="276edeeb-383f-44e6-9957-d8e9372e72d6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>82</refundId>
      </ns:acr_GetRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="16f0d6f2-40e4-4c5d-83ab-42a327488cc7" name="SOAP Response"/><con:assertion type="XPath Match" id="c94185e3-f986-436e-8e25-cc3cd0a0a7e4" name="XPath Match"><con:configuration><path>matches(//return/refund/status, "OK")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_GetRefund"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="cb23c4cd-8dc1-4f7c-b5ea-2b710448ec88" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking &amp; Refund_Adult+ChildFree" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="e100a4b2-1a03-4e1f-babd-4e7807b03f54"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="15e9ea4c-be37-4a6e-aba5-6408282c9c96" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>MAD</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>BCN</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>2015-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="546eaa5b-b586-443b-8e1e-e21c6296154e"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"] and journeyInfo/ticketOptions[ticketOption="ETK"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="033cd10e-bad4-4821-8c13-e3aeaaab9f75" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8779</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="Simple Contains" id="be435315-e02d-4985-83c6-c0fd7aa58adf" name="Contains"><con:configuration><token>&lt;fareName>FLEXIBLE, Niño menor de 4 años&lt;/fareName>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="850bcba2-76ba-4af7-afe9-6fa44a66c9a5"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="deb133f1-6e5c-46df-892b-39ba4125aa5d"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="b9eb02d5-16a9-43d6-ac0e-1e6ceedd7bd5" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>68674</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2015-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="19e53c22-4319-44bf-a435-d8c688edaeb4"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="75f042a6-eaf2-4fde-b306-7e6b0245f8c0" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>272</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: bookingId" id="5d57f9cf-c94f-49c9-b23f-fd73c00673a0"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Booking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreRefund</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="delay" name="Delay 1" id="6e63f212-7620-45e0-aa40-4dfdf1d24290"><con:settings/><con:config><delay>3000</delay></con:config></con:testStep><con:testStep type="request" id="03758f56-b997-4aaf-af96-818509d11e07" name="acr_PreRefund"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreRefund</con:operation><con:request name="acr_PreRefund" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="3a17447d-e3f8-4d8a-af58-d05663d91db0"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreRefund>
        <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>272</bookingId>
      </ns:acr_PreRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="c792ccd7-6460-4db6-9881-5ac3877082ab" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreRefund"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: refundId" id="0ce63808-53d7-4618-ba58-760202117959"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreRefund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Refund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="a0475317-c972-469d-b949-3c9a53c8cfb0" name="acr_Refund"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Refund</con:operation><con:request name="acr_Refund" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="d53948c5-ac6f-4069-bdea-41ea51b4508e"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Refund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>83</refundId>
      </ns:acr_Refund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5721d579-08d7-4bbf-a04f-ebdeea6920d3" name="SOAP Response"/><con:assertion type="XPath Match" id="27f4b24d-d4e9-447f-9c38-9ff648199ab0" name="XPath Match"><con:configuration><path>matches(//return/refund/status, "OK")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Refund"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 3: refundId" id="3d39dae6-e7c5-426b-9244-8e6b4346c167"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Refund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetRefund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="6dca4b2a-87de-4cdc-9e1a-1bf54e9a67c9" name="acr_GetRefund"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetRefund</con:operation><con:request name="acr_GetRefund" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="276edeeb-383f-44e6-9957-d8e9372e72d6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>83</refundId>
      </ns:acr_GetRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="16f0d6f2-40e4-4c5d-83ab-42a327488cc7" name="SOAP Response"/><con:assertion type="XPath Match" id="c94185e3-f986-436e-8e25-cc3cd0a0a7e4" name="XPath Match"><con:configuration><path>matches(//return/refund/status, "OK")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_GetRefund"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="e1b1b78b-76ff-4dff-af6d-6e7e5ee38c8e" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking_Child+ChildFreeNEG" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="6bc16217-43c3-4b56-bbad-7b906580962d"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="0dee7cf3-6d7b-4403-bf52-ec7b7c0755ca" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7110600</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7114100</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>2010-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>2015-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="194f11d4-326d-4680-8d61-864887806094"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"] and journeyInfo/ticketOptions[ticketOption="ETK"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="90e125fe-065d-4eee-a559-24c6b8cd8699" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8843</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="a734bf3b-df04-4674-b698-d8c7ecae08a1"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="df65a295-0338-48dd-86dc-ddb952ad1bf2"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="fa7874fd-15db-4b7a-8f13-68963e1ae1fe" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>69085</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2010-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2015-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Not SOAP Fault Assertion" id="497a95ca-c008-46ff-9e82-fa6409e51eec" name="SOAP Fault"/><con:assertion type="Simple Contains" id="d5727c72-2265-4dab-bfa1-81ee8310e70c" name="Contains"><con:configuration><token>0: Количество мест с полным тарифом должно быть не меньше, чем количество детей без места</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="6ab95d2b-0a12-4d84-a8aa-309439f97611" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Roundtrip Book &amp; Coupon 2 pass" searchProperties="true" timeout="120000" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="properties" name="Properties of search" id="f381d4d2-4423-4c06-9386-82e64fc7f587"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>date of travel</con:name><con:value>${=(new Date()+2).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>Departure</con:name><con:value>mad</con:value></con:property><con:property><con:name>Destination</con:name><con:value>BCN</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer" id="8d3009ce-c774-4e1c-826f-905867f73ae9"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>MAD-BCN</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>MAD-BCN</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>MAD-BCN</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script: set endpoint" id="b62adeef-1135-451d-b5b1-90a6a30b2520"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }</script></con:config></con:testStep><con:testStep type="request" id="a770619f-8305-4fc2-8645-75eef5a6b591" name="MAD-BCN"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="MAD-BCN" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>mad</originCode>
            <originDate>${=(new Date()+2).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>BCN</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="c44bf8fc-6563-444b-8fe8-75747929fd69" name="XPath Match 2"><con:configuration><path>matches(//roundtripJourneys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyIdRT" id="55007b39-c609-4c81-9db9-048557e4ff92"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>MAD-BCN</con:sourceStep><con:sourcePath>//journeys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyRoundtrip</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>MAD-BCN</con:sourceStep><con:sourcePath>//roundtripJourneys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//roundtripJourneyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="8585153b-c494-47e4-8818-02ce96b7dbe7" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8881</journeyId>
         <roundtripJourneyId>8914</roundtripJourneyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="XPath Match" id="5a4db4d5-441e-4d1f-8c67-881f6631ea49" name="XPath Match"><con:configuration><path>matches(//fareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="05fa72d9-2e99-43bd-8ca6-b879ce635dc4" name="XPath Match 1"><con:configuration><path>matches(//roundtripFareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferIdRT" id="eed63c62-63b6-41f5-b46c-893742d15eeb"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers//fareOffer[fareName="IDA Y VUELTA"]//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>ticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//bookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTfareOffer</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers//fareOffer[fareName="IDA Y VUELTA"]//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripFareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripBookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="62e96085-eb44-4abf-a555-b3b2da82676e" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <fareOfferId>69319</fareOfferId>
         <roundtripFareOfferId>69611</roundtripFareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <roundtripBookingRequest>
            <!--You may enter the following 19 items in any order-->
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </roundtripBookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>yy@xx.xx</email>
            </passenger>
         </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="6bc15c0f-38a1-4b9a-8486-b4e10b3150ef"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="d23f45a4-7961-4f73-bfaf-155f07d29866" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>276</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: boukingId" id="8ea47098-5537-40ad-973d-1acb6c23d35f"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetBooking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="29f4c71b-156b-43ba-abc4-24f9a175ad3e" name="acr_GetBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetBooking</con:operation><con:request name="acr_GetBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="418d456e-8385-4bd5-8512-a8d239b06f79"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>276</bookingId>
      </ns:acr_GetBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2be17077-0305-4b2a-9b4e-4e3614d4b7ff" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_GetBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Coupon: coupon" id="b0efd968-cf5e-4427-b587-7e3ff231388a"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_GetBooking</con:sourceStep><con:sourcePath>//coupons/coupon/couponId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetCoupons</con:targetStep><con:targetPath>//couponId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="ab4c6314-777d-469f-8839-8b6578939783" name="acr_GetCoupons"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetCoupons</con:operation><con:request name="acr_GetCoupons" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="13fed1c3-92df-40d7-ab19-5a004ab9eb8b"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetCoupons>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <coupons>
            <!--Zero or more repetitions:-->
            <coupon>
               <!--You may enter the following 2 items in any order-->
               <couponId>8</couponId>
               <couponPdf>true</couponPdf>
            </coupon>
         </coupons>
      </ns:acr_GetCoupons>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="afb5cb0a-23ac-4d6d-8f9a-d57100e31da8" name="SOAP Response"/><con:assertion type="XPath Match" id="d6c5f1c7-707a-4dc8-b19b-0729e59ea05a" name="XPath Match"><con:configuration><path>exists(//coupons/coupon/couponPdf)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_GetCoupons"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>searchCounter</con:name><con:value>0</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="0a230651-35b0-4866-ab09-f649bc8136bd" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Roundtrip Book &amp; Refund" searchProperties="true" timeout="120000" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="properties" name="Properties of search" id="31367ca4-8e92-4186-8851-1cd3a9338ba8"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>date of travel</con:name><con:value>${=(new Date()+2).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>Departure</con:name><con:value>mad</con:value></con:property><con:property><con:name>Destination</con:name><con:value>BCN</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer" id="c63568cc-dff8-4d28-a8f7-e8a305c826bb"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>MAD-BCN</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>MAD-BCN</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>MAD-BCN</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script: set endpoint" id="bc388dc8-0fb0-4091-abab-31a3a45a225f"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }</script></con:config></con:testStep><con:testStep type="request" id="2135ce99-7028-476e-ae19-6ed9ca0ec45c" name="MAD-BCN"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="MAD-BCN" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>mad</originCode>
            <originDate>${=(new Date()+2).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>BCN</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="c44bf8fc-6563-444b-8fe8-75747929fd69" name="XPath Match 2"><con:configuration><path>matches(//roundtripJourneys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyIdRT" id="f53cc1ab-29ed-4b05-a806-1b2327bcbdcb"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>MAD-BCN</con:sourceStep><con:sourcePath>//journeys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyRoundtrip</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>MAD-BCN</con:sourceStep><con:sourcePath>//roundtripJourneys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//roundtripJourneyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="598404e9-7515-4c18-b1e7-456a063b2207" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8996</journeyId>
         <roundtripJourneyId>9029</roundtripJourneyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="XPath Match" id="5a4db4d5-441e-4d1f-8c67-881f6631ea49" name="XPath Match"><con:configuration><path>matches(//fareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="05fa72d9-2e99-43bd-8ca6-b879ce635dc4" name="XPath Match 1"><con:configuration><path>matches(//roundtripFareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferIdRT" id="e89d97a3-dd38-4b0b-bbec-75b0c2712865"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers//fareOffer[fareName="IDA Y VUELTA"]//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>ticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//bookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTfareOffer</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers//fareOffer[fareName="IDA Y VUELTA"]//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripFareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripBookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="7b5b46d8-fb11-4c7e-acbd-478019b9e832" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <fareOfferId>70408</fareOfferId>
         <roundtripFareOfferId>70700</roundtripFareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <roundtripBookingRequest>
            <!--You may enter the following 19 items in any order-->
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </roundtripBookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>yy@xx.xx</email>
            </passenger>
         </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="59534eba-ba88-4c03-a5b9-0e7a6100a73c"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="b1f5398b-253e-47b9-863c-4f088e9d4c42" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>281</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: boukingId" id="2423fe8e-0b87-4935-9068-ee2cc22a6d17"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreRefund</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="delay" name="Delay" id="4807171a-2a9d-4882-9514-b428b26f846d"><con:settings/><con:config><delay>3000</delay></con:config></con:testStep><con:testStep type="request" name="acr_PreRefund" id="82161573-2ca3-47aa-bd01-4a8171c09642"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreRefund</con:operation><con:request name="acr_PreRefund" id="c2b85959-20ae-4eb4-b694-12ab465cf1b0"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>281</bookingId>
      </ns:acr_PreRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ba8a8717-8338-4366-b43e-4a198e8e43f1"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: refundId" id="f06fa554-1f08-4f48-9e3b-ad4565572e1d"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreRefund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Refund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" name="acr_Refund" id="e9805765-2044-474e-9301-3fa3b1a14ce3"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Refund</con:operation><con:request name="acr_Refund" id="8a10b4b6-00c1-46d6-a079-de318274da5d"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Refund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <refundId>84</refundId>
      </ns:acr_Refund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8b06932-dcc6-4db4-a1ba-8c30a84a72a4"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer 3: refundId" id="0029993c-d083-45d7-87a4-ce126ef26413"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Refund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetRefund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" name="acr_GetRefund" id="9cf14a60-33d2-4e57-a1fd-954148f31e43"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetRefund</con:operation><con:request name="acr_GetRefund" id="ea4cb7d1-6551-4833-8e1e-8b90bf6cec60"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>84</refundId>
      </ns:acr_GetRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="50cac8a7-bd47-4b3b-b295-4886e23c9777"/><con:assertion type="Simple NotContains" id="217e821f-1223-46ce-9604-ab2de1f4f580" name="Not Contains"><con:configuration><token>fault</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>searchCounter</con:name><con:value>0</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="21fd8379-ea6d-4236-8715-1cc5d802b126" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Roundtrip Book &amp; Refund_Adult+Child" searchProperties="true" timeout="120000" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="properties" name="Properties of search" id="3cdec6c3-bbdf-4175-8ad4-f6f4e1a37db9"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>date of travel</con:name><con:value>${=(new Date()+10).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>Departure</con:name><con:value>MAD</con:value></con:property><con:property><con:name>Destination</con:name><con:value>BCN</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer" id="d09af3d5-93b0-4ec4-a4dc-22bdccea7464"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>MAD-BCN</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>MAD-BCN</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>MAD-BCN</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script: set endpoint" id="d2f694e5-07e5-4975-87a8-dc2b0c222e7b"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }</script></con:config></con:testStep><con:testStep type="request" id="b4c6c1d1-fad9-451a-a453-1433b03cfb4a" name="MAD-BCN"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="MAD-BCN" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>MAD</originCode>
            <originDate>${=(new Date()+10).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>BCN</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+20).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>2010-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="c44bf8fc-6563-444b-8fe8-75747929fd69" name="XPath Match 2"><con:configuration><path>matches(//roundtripJourneys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyIdRT" id="9e0e72ce-6af0-494d-92dd-2962f6ebb9ca"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>MAD-BCN</con:sourceStep><con:sourcePath>//journeys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyRoundtrip</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>MAD-BCN</con:sourceStep><con:sourcePath>//roundtripJourneys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//roundtripJourneyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="f40df893-7d03-4c7f-b5dd-0b5b2b47294c" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>5615</journeyId>
         <roundtripJourneyId>5632</roundtripJourneyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="XPath Match" id="5a4db4d5-441e-4d1f-8c67-881f6631ea49" name="XPath Match"><con:configuration><path>matches(//fareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="05fa72d9-2e99-43bd-8ca6-b879ce635dc4" name="XPath Match 1"><con:configuration><path>matches(//roundtripFareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="699bc3b6-ab48-4145-b0d9-c3d190613bf6" name="Contains"><con:configuration><token>&lt;fareName>FLEXIBLE, Nino&lt;/fareName>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferIdRT" id="c470eef9-44d2-42fe-9523-4ce59135774c"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers//fareOffer[fareName="FLEXIBLE, Nino"]//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>ticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//bookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTfareOffer</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers//fareOffer[fareName="FLEXIBLE, Nino"]//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripFareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripBookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="e47c80d8-3eff-4288-a58d-542128dfd65b" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <fareOfferId>42331</fareOfferId>
         <roundtripFareOfferId>42377</roundtripFareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <roundtripBookingRequest>
            <!--You may enter the following 19 items in any order-->
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </roundtripBookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2010-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>yy@xx.xx</email>
            </passenger>
         </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="685f3dfb-aca0-47b6-a18d-5c08e89ada4e"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="dbf46ddd-9149-4063-a3c2-0b28b6e773cf" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>159</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: boukingId" id="3635d3e2-dd74-4c5c-bf24-f567870e8d18"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreRefund</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="delay" name="Delay" id="c4adda28-5cf8-4326-bad1-73fb5a1d057a"><con:settings/><con:config><delay>3000</delay></con:config></con:testStep><con:testStep type="request" name="acr_PreRefund" id="56d08ab2-4efe-4050-ba3c-42dd3b7c9634"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreRefund</con:operation><con:request name="acr_PreRefund" id="c2b85959-20ae-4eb4-b694-12ab465cf1b0"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>159</bookingId>
      </ns:acr_PreRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ba8a8717-8338-4366-b43e-4a198e8e43f1"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: refundId" id="f7bb536c-8cba-433b-879b-c72f10b06518"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreRefund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Refund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" name="acr_Refund" id="03b1fc30-afdd-470a-b272-246704b6ca92"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Refund</con:operation><con:request name="acr_Refund" id="8a10b4b6-00c1-46d6-a079-de318274da5d"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Refund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <refundId>43</refundId>
      </ns:acr_Refund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8b06932-dcc6-4db4-a1ba-8c30a84a72a4"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer 3: refundId" id="33169c11-5c6d-4f5d-a7ca-f3fa004f73cb"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Refund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetRefund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" name="acr_GetRefund" id="c553e1ea-8bf2-4687-8d95-c068fe769dbe"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetRefund</con:operation><con:request name="acr_GetRefund" id="ea4cb7d1-6551-4833-8e1e-8b90bf6cec60"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>43</refundId>
      </ns:acr_GetRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="50cac8a7-bd47-4b3b-b295-4886e23c9777"/><con:assertion type="Simple NotContains" id="02b6ff32-42a7-40fe-a226-881506c2fc08" name="Not Contains"><con:configuration><token>fault</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>searchCounter</con:name><con:value>0</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="627894e0-4acd-406a-869d-c5fc3d7d3abf" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Roundtrip Book &amp; Refund_Adult+ChildFree" searchProperties="true" timeout="120000" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="properties" name="Properties of search" id="739b258f-00f5-4685-8da5-64a2d2bab86d"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>date of travel</con:name><con:value>${=(new Date()+10).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>Departure</con:name><con:value>MAD</con:value></con:property><con:property><con:name>Destination</con:name><con:value>BCN</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer" id="b7570618-131b-42a8-b2d1-4f006ee7a61c"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>MAD-BCN</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>MAD-BCN</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>MAD-BCN</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script: set endpoint" id="bd495362-47d2-41a2-89e7-389105bcb306"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }</script></con:config></con:testStep><con:testStep type="request" id="5f4ff945-2f03-49fa-85f3-37d29acac9fe" name="MAD-BCN"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="MAD-BCN" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>MAD</originCode>
            <originDate>${=(new Date()+10).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>BCN</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+20).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>2015-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="c44bf8fc-6563-444b-8fe8-75747929fd69" name="XPath Match 2"><con:configuration><path>matches(//roundtripJourneys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyIdRT" id="64e47fe0-d94f-40ac-82d8-a0671dff52af"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>MAD-BCN</con:sourceStep><con:sourcePath>//journeys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyRoundtrip</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>MAD-BCN</con:sourceStep><con:sourcePath>//roundtripJourneys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//roundtripJourneyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="63268997-b3db-4c82-9506-91f851df843f" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>9105</journeyId>
         <roundtripJourneyId>9123</roundtripJourneyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="XPath Match" id="5a4db4d5-441e-4d1f-8c67-881f6631ea49" name="XPath Match"><con:configuration><path>matches(//fareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="05fa72d9-2e99-43bd-8ca6-b879ce635dc4" name="XPath Match 1"><con:configuration><path>matches(//roundtripFareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="da98207a-bfb6-4a32-ba22-a72c1cabd01f" name="Contains"><con:configuration><token>&lt;fareName>Promo, Niño menor de 4 años&lt;/fareName>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferIdRT" id="4a8c2c37-5c60-4f7f-af93-5604a664a0b8"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers//fareOffer[fareName="Promo, Niño menor de 4 años"]//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>ticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//bookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTfareOffer</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers//fareOffer[fareName="Promo, Niño menor de 4 años"]//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripFareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripBookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="f2a06e1d-cec9-430f-8c42-f51bea18e7df" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <fareOfferId>71401</fareOfferId>
         <roundtripFareOfferId>71573</roundtripFareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <roundtripBookingRequest>
            <!--You may enter the following 19 items in any order-->
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </roundtripBookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2015-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>yy@xx.xx</email>
            </passenger>
         </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="d5cec6f0-1fb9-47e6-bdf4-9de7363d2041"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="fef0be63-12ab-4997-abdc-3a70e2ce1382" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>286</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: boukingId" id="d012a8cc-e9d6-4747-999a-591be0520e58"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreRefund</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="delay" name="Delay" id="67b2c773-6661-40f1-9036-0bb6e526e3a2"><con:settings/><con:config><delay>3000</delay></con:config></con:testStep><con:testStep type="request" name="acr_PreRefund" id="71f1c9e7-b0c3-4521-9a54-7739962a02b7"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreRefund</con:operation><con:request name="acr_PreRefund" id="c2b85959-20ae-4eb4-b694-12ab465cf1b0"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>286</bookingId>
      </ns:acr_PreRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ba8a8717-8338-4366-b43e-4a198e8e43f1"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: refundId" id="228baeaf-1f2b-4fc8-9bde-030496e37587"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreRefund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Refund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" name="acr_Refund" id="8a45e1ea-f8c0-4741-9b9e-ad9e72754b42"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Refund</con:operation><con:request name="acr_Refund" id="8a10b4b6-00c1-46d6-a079-de318274da5d"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Refund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <refundId>86</refundId>
      </ns:acr_Refund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8b06932-dcc6-4db4-a1ba-8c30a84a72a4"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer 3: refundId" id="75928cc7-112b-432a-9d99-265d1944397d"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Refund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetRefund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" name="acr_GetRefund" id="09d5100b-7641-42f7-9dea-e8e591a6d6d8"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetRefund</con:operation><con:request name="acr_GetRefund" id="ea4cb7d1-6551-4833-8e1e-8b90bf6cec60"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>86</refundId>
      </ns:acr_GetRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="50cac8a7-bd47-4b3b-b295-4886e23c9777"/><con:assertion type="Simple NotContains" id="6e7cf627-735e-43da-aa5c-b9306843495a" name="Not Contains"><con:configuration><token>fault</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>searchCounter</con:name><con:value>0</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="6cc2671d-a7f5-4d12-ac60-3853e6ef48e4" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Roundtrip Book_ChildFree+ChildNEG" searchProperties="true" timeout="120000" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="properties" name="Properties of search" id="8185d75d-f562-4cce-9034-1fb89864f289"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>date of travel</con:name><con:value>${=(new Date()+18).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>Departure</con:name><con:value>MAD</con:value></con:property><con:property><con:name>Destination</con:name><con:value>BCN</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer" id="0fe27307-88a8-41d9-8b25-8cf548c18a24"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>MAD-BCN</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>MAD-BCN</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>MAD-BCN</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script: set endpoint" id="9ba0bc70-ada2-4722-b4ba-1e529aa2013a"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }</script></con:config></con:testStep><con:testStep type="request" id="d6a5314e-6fd2-487c-aaa4-60d6af15dd05" name="MAD-BCN"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="MAD-BCN" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>MAD</originCode>
            <originDate>${=(new Date()+18).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>BCN</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+20).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>2010-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>2015-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="c44bf8fc-6563-444b-8fe8-75747929fd69" name="XPath Match 2"><con:configuration><path>matches(//roundtripJourneys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyIdRT" id="5993af8c-787b-419a-a9c6-ec3011d02162"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>MAD-BCN</con:sourceStep><con:sourcePath>//journeys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyRoundtrip</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>MAD-BCN</con:sourceStep><con:sourcePath>//roundtripJourneys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//roundtripJourneyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="2744fb92-1327-416f-8f99-9ccd5e2c7995" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>9175</journeyId>
         <roundtripJourneyId>9193</roundtripJourneyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="XPath Match" id="5a4db4d5-441e-4d1f-8c67-881f6631ea49" name="XPath Match"><con:configuration><path>matches(//fareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="05fa72d9-2e99-43bd-8ca6-b879ce635dc4" name="XPath Match 1"><con:configuration><path>matches(//roundtripFareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="da98207a-bfb6-4a32-ba22-a72c1cabd01f" name="Contains"><con:configuration><token>&lt;fareName>Nino, Niño menor de 4 años&lt;/fareName>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferIdRT" id="bf56ac5b-1649-4b01-ac53-00d9771dcc44"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers//fareOffer[fareName="Nino, Niño menor de 4 años"]//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>ticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//bookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTfareOffer</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers//fareOffer[fareName="Nino, Niño menor de 4 años"]//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripFareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripBookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="0d3605bc-c813-4c9d-870e-571d0fc1532f" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <fareOfferId>72014</fareOfferId>
         <roundtripFareOfferId>72061</roundtripFareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <roundtripBookingRequest>
            <!--You may enter the following 19 items in any order-->
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </roundtripBookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2010-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2015-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>yy@xx.xx</email>
            </passenger>
         </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>searchCounter</con:name><con:value>0</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="00907b98-3fbb-4aea-94f7-bfa093f0210a" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking Familia" searchProperties="true"><con:settings/><con:testStep type="properties" name="Properties of search" id="887cde65-91a2-4293-b761-da0df69158ef"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>date of travel</con:name><con:value>${=(new Date()+4).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>Departure</con:name><con:value>7130100</con:value></con:property><con:property><con:name>Destination</con:name><con:value>7117000</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer" id="cec206f1-b2cf-4320-9607-446be9a867fa"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>acr_JourneySearch 4 passengers</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>acr_JourneySearch 4 passengers</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>acr_JourneySearch 4 passengers</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script: set endpoint" id="0a592145-4cd2-48a4-80f2-321d54543789"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="ea5c5008-3c57-4938-b44e-c226af742f83" name="acr_JourneySearch 4 passengers"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch 4 passengers" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7130100</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7117000</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="cbc0ca3d-7cbd-4f5e-a2b6-9fdffa70a869"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch 4 passengers</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"][operatorName="Renfe"][trainName="TRENHOTEL"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch 4 passengers</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="f7a70412-f34f-4dd7-932c-13e60fa33cd6" name="acr_FareOfferSearch 4 passengers"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch 4 passengers" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>9209</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Success Familiar Found" id="7dbfbc08-3674-4629-961f-21a35df1d28b"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch 4 passengers#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"


  def xml = holder.getPrettyXml();
  def regexp = ("&lt;serviceClass>(.*?)Familiar&lt;/serviceClass>");
  def matcher = xml =~ regexp;

  def foundTariffs = 0

  matcher.each {
  foundTariffs++
  log.info it
  }


  if( foundTariffs == 0 )
  testRunner.fail( "It didn't work" )
  else
  log.info "Found offers : ${foundTariffs} "</script></con:config></con:testStep><con:testStep type="request" id="3691a136-762b-4e9a-ad12-d95c8c583b98" name="acr_JourneySearch 3 passengers"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch 3 passengers" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7130100</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7117000</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer: journeyId" id="8d3ba7b4-5f67-47a3-a366-86a79edc124e"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch 3 passengers</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"][operatorName="Renfe"][trainName="TRENHOTEL"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch 3 passengers</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="25781c3f-dc5a-44bd-9212-b3519650cef9" name="acr_FareOfferSearch 3 passengers"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch 3 passengers" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>9220</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="Simple NotContains" id="fdb40640-399f-4596-937e-96f51a251390" name="Not Contains"><con:configuration><token>fault</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Success Familiar NOT Found" id="9a47790d-bd57-4c18-85f7-a233935dec4b"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch 3 passengers#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"


  def xml = holder.getPrettyXml();
  def regexp = ("&lt;serviceClass>(.*?)Familiar&lt;/serviceClass>");
  def matcher = xml =~ regexp;

  def foundTariffs = 0

  matcher.each {
  foundTariffs++
  log.info it
  }


  if( foundTariffs >  0 )
  testRunner.fail( "It didn't work" )
  else
  log.info "Found offers : ${foundTariffs} "</script></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="e2d91b2b-3e79-430d-8b37-1f684bd03041" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking Double Familiar" searchProperties="true"><con:settings/><con:testStep type="properties" name="Properties of search" id="c7682a5a-3d30-4254-8e3d-8001aba96896"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>date of travel</con:name><con:value>${=(new Date()+2).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>Departure</con:name><con:value>7122308</con:value></con:property><con:property><con:name>Destination</con:name><con:value>7171801</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer" id="84bbbc06-622d-4338-9f63-44ce2e265962"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>acr_JourneySearch 2 passengers</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>acr_JourneySearch 2 passengers</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>acr_JourneySearch 2 passengers</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script: set endpoint" id="f1fe935e-0475-4e57-8c72-2f05096dfc1c"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="fd108792-458b-4e9c-a1a5-91cb5f1d57b1" name="acr_JourneySearch 2 passengers"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch 2 passengers" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7122308</originCode>
            <originDate>${=(new Date()+2).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7171801</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="e1c747e7-bfe4-44d9-8e5f-3c430ce87591"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch 2 passengers</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"][operatorName="Renfe"][trainName="TRENHOTEL"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch 2 passengers</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="90390362-e069-4897-b89c-2d8d67e5876c" name="acr_FareOfferSearch 2 passengers"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch 2 passengers" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>9231</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Success Familiar Found" id="b0f4df8b-10f1-4ccb-ab79-b36e7e08f727"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch 2 passengers#Response")

  String status = holder.getNodeValue("//faultstring")


  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"


  def xml = holder.getPrettyXml();
  def regexp = ("&lt;serviceClass>(.*?)Doble Familiar&lt;/serviceClass>");
  def matcher = xml =~ regexp;

  def foundTariffs = 0

  matcher.each {
  foundTariffs++
  log.info it
  }


  if( foundTariffs == 0 )
  testRunner.fail( "It didn't work" )
  else
  log.info "Found offers : ${foundTariffs} "</script></con:config></con:testStep><con:testStep type="request" id="433ae519-23af-44cb-837f-23907676bdc5" name="acr_JourneySearch 1 passenger"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch 1 passenger" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7130100</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7117000</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer: journeyId" id="70593800-7555-4656-b92f-2b60817210eb"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch 1 passenger</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"][operatorName="Renfe"][trainName="TRENHOTEL"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch 1 passenger</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="6d2caf30-f698-44a6-9f5f-d3c17f2ab93b" name="acr_FareOfferSearch 1 passenger"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch 1 passenger" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>9232</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="Simple NotContains" id="f05b699d-6d0e-4b28-b8cb-10194c6f41e6" name="Not Contains"><con:configuration><token>fault</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Success Familiar NOT Found" id="75d78771-9a15-440f-b4b0-a8cb563747c4"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch 1 passenger#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"


  def xml = holder.getPrettyXml();
  def regexp = ("&lt;serviceClass>(.*?)Double Familiar&lt;/serviceClass>");
  def matcher = xml =~ regexp;

  def foundTariffs = 0

  matcher.each {
  foundTariffs++
  log.info it
  }


  if( foundTariffs >  0 )
  testRunner.fail( "It didn't work" )
  else
  log.info "Found offers : ${foundTariffs} "</script></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="6ceee7bb-2514-4366-a850-d75bbf62426e" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking Infant" searchProperties="true"><con:settings/><con:testStep type="properties" name="Properties of search" id="cfc263e4-31b3-4b3b-bc1a-14a3f98af55d"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>date of travel</con:name><con:value>${=(new Date()+4).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>Departure</con:name><con:value>7130100</con:value></con:property><con:property><con:name>Destination</con:name><con:value>7117000</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer" id="e133eb22-e4b5-4cbd-bfb3-b9ccf0119fe7"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>acr_JourneySearch 1 Adult 2 Infants</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>acr_JourneySearch 1 Adult 2 Infants</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>acr_JourneySearch 1 Adult 2 Infants</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script: set endpoint" id="21a52a05-1039-48a2-8a17-2386ca62ac74"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="d3ac71ed-bf69-4fce-8289-7069ab9d538b" name="acr_JourneySearch 1 Adult 2 Infants"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch 1 Adult 2 Infants" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7130100</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7117000</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>${=(new Date()-30).format('yyyy-MM-dd')}</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>${=(new Date()-30).format('yyyy-MM-dd')}</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="c8c63f6f-349b-43cb-b076-92ec4b09aca5"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch 1 Adult 2 Infants</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"][operatorName="Renfe"][trainName="TRENHOTEL"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch 1 Adult 2 Infants</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="cc6c447c-b079-471c-ac3e-120a2a6f108a" name="acr_FareOfferSearch 1 Adult 2 Infants"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch 1 Adult 2 Infants" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>9243</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="Simple NotContains" id="31fefe19-ae1f-45e7-9906-0b8a58f83006" name="Not Contains"><con:configuration><token>fault</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Infant Not Found" id="799d52ce-b423-411e-8d72-d264002fa01a"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch 1 Adult 2 Infants#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"


  def xml = holder.getPrettyXml();
  def regexp = ("&lt;serviceClass>(.*?)Infant&lt;/serviceClass>");
  def matcher = xml =~ regexp;

  def foundTariffs = 0

  matcher.each {
  foundTariffs++
  log.info it
  }


  if( foundTariffs >  0 )
  testRunner.fail( "Found offers : ${foundTariffs} " )
  else
  log.info "Infant not found"
  log.info "Status: OK"</script></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="49529ccb-8577-4483-94ea-958091b180df" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking &amp; Void" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="18abdf71-8854-4f91-b266-13350f1869ba"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="4d7c994b-698e-4af7-9e0e-6366d96520a0" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7110600</originCode>
            <originDate>${=(new Date()+10).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7114100</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>2010-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="b1a1fb6c-fbba-40d8-ac47-00beccf1c6a7"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"] and journeyInfo/ticketOptions[ticketOption="ETK"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="0f64c2ac-3b12-4048-9bb2-2b2f411d8a10" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>9254</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="bcd5c640-9b2c-40d9-9a64-7453c05c09cf"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="b546e8f5-9031-4aa3-8922-20f700ff6972"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="e37f3c98-a062-4821-8aa9-e4b19d45ff10" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>72252</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>Child name</name>
               <surname>Child surname</surname>
               <patronymic>Test</patronymic>                           
               <birthDate>2010-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="3cc49f91-077f-44dc-94be-5baf0a4dc37b"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="d41c87ec-f3d7-48d7-b792-a2bd82ac5f92" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>290</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: bookingId" id="66372a63-f111-4c28-a772-5a2266d16261"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Booking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Cancel</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="delay" name="Delay 1" id="3b63222b-fc9d-4be1-a29e-ee5241f49793"><con:settings/><con:config><delay>3000</delay></con:config></con:testStep><con:testStep type="request" id="0b1318ee-7c64-40e6-afe7-5d19d505627b" name="acr_Cancel"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Cancel</con:operation><con:request name="acr_Cancel" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="6da5987b-4b1a-4ef6-8304-05b3970c49dd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Cancel>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>290</bookingId>
      </ns:acr_Cancel>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="9bbcb2b2-2b38-41b9-a386-97ac496fcdeb" name="SOAP Response"/><con:assertion type="XPath Match" id="52cc9f32-e216-420b-9d5f-5bbf65eb8dae" name="XPath Match"><con:configuration><path>matches(//booking/status, "XX")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Cancel"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="9e4c995b-4faa-4881-bdbb-23ecbae92573" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking Nino" searchProperties="true"><con:settings/><con:testStep type="properties" name="Properties of search" id="4838d179-1970-40d3-9425-f7f0760eb142"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>date of travel</con:name><con:value>${=(new Date()+4).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>Departure</con:name><con:value>7130100</con:value></con:property><con:property><con:name>Destination</con:name><con:value>7117000</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer" id="3693eb5f-f73b-4bc3-83e2-01d44ba1c3f0"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>acr_JourneySearch 1 Adult 2 Infants</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>acr_JourneySearch 1 Adult 2 Infants</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>acr_JourneySearch 1 Adult 2 Infants</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script: set endpoint" id="1a103fe7-ae20-498e-b683-8ddbe542f04b"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="e808bf7b-3951-4890-af67-46ef7918deb9" name="acr_JourneySearch 1 Adult 2 Infants"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch 1 Adult 2 Infants" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>7130100</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>7117000</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>${=(new Date()-30).format('yyyy-MM-dd')}</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>${=(new Date()-30).format('yyyy-MM-dd')}</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="e0317cfb-cc66-4e0e-aa1d-48c7f8361e8e"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch 1 Adult 2 Infants</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"][operatorName="Renfe"][trainName="TRENHOTEL"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch 1 Adult 2 Infants</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="ae6616bf-2629-40d7-8f4a-16a5c333b593" name="acr_FareOfferSearch 1 Adult 2 Infants"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch 1 Adult 2 Infants" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>9316</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="Simple NotContains" id="41a4d54d-bba9-4eba-b187-1568fea7da85" name="Not Contains"><con:configuration><token>fault</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Infant Not Found" id="579d35ef-0349-4f29-8154-bf0ffbd5a265"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch 1 Adult 2 Infants#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"


  def xml = holder.getPrettyXml();
  def regexp = ("&lt;serviceClass>(.*?)Infant&lt;/serviceClass>");
  def matcher = xml =~ regexp;

  def foundTariffs = 0

  matcher.each {
  foundTariffs++
  log.info it
  }


  if( foundTariffs >  0 )
  testRunner.fail( "Found offers : ${foundTariffs} " )
  else
  log.info "Infant not found"
  log.info "Status: OK"</script></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="f9352cea-9729-4730-988b-2f717772f59d" failOnError="false" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking elipsos" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="7a26c82c-8fa3-462a-b212-a3b49426ce8f"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="4359e699-2d42-41ff-8d52-8d1e46f1b3f8" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>BCN</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>8700013</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="3069e70f-8213-4356-9854-1c01c77f76a1"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="3e7b9ccd-e425-4ec3-9bfe-531c69326f8c" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>9327</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="2f9c9900-85ca-4e81-8328-04422958a651"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="17204f71-9985-4357-8786-7aacc3a27c51"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId1</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBookingNEG_changePassCount</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId2</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBookingNEG_changePassBirthDate</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId3</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBookingNEG_NoSalutation</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId4</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking_nearWindow</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId5</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking_nearPass</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId6</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking_withoutWindow</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="f2a6bf5e-5711-45ec-a684-787e40a8eb5c" name="acr_PreBookingNEG_changePassCount" disabled="true"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBookingNEG_changePassCount" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>72627</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="cd530d02-b050-426d-bf9d-ef9b54219a61" name="Contains"><con:configuration><token>3603: Введены некорректные данные.</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="128de7ad-93fb-4a53-861f-7078dc7f4202" name="acr_PreBookingNEG_changePassBirthDate" disabled="true"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBookingNEG_changePassBirthDate" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>72627</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1991-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
           
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="cd530d02-b050-426d-bf9d-ef9b54219a61" name="Contains"><con:configuration><token>3711: Даты рождения должны совпадать с датами рождения, введенными для поиска.</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="4ca783c0-2c51-4a58-943f-84b5eb82198a" name="acr_PreBookingNEG_NoSalutation" disabled="true"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBookingNEG_NoSalutation" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>72627</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
           
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="cd530d02-b050-426d-bf9d-ef9b54219a61" name="Contains"><con:configuration><token>2403: Некорректное обращение к пассажиру.</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="c1e13f66-e06f-48f0-99b9-a42ada7f3768" name="acr_PreBooking_nearWindow" disabled="true"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking_nearWindow" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>72627</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
            <possiblePositions>window</possiblePositions>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="57a0558a-3464-46cb-9d51-60d9bbb63f2e" name="acr_PreBooking_nearPass" disabled="true"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking_nearPass" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>72627</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
            <possiblePositions>aisle</possiblePositions>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="57d6a05a-700d-4d47-a84d-5ac3da5fec5d" name="acr_PreBooking_withoutWindow" disabled="true"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking_withoutWindow" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>72627</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
            <possiblePositions>window_isolated</possiblePositions>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="07f8e309-eebf-435c-8552-936aa2c2e51b" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>72627</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
         <contactDetails/>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="66170f4c-2c6a-4075-a212-7c74dfeb917a"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="dac73af5-66d3-4141-bb78-3b275868017a" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>291</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:properties><con:property><con:name>EStoES route</con:name><con:value>BARCE,MADRI</con:value></con:property><con:property><con:name>originDate</con:name><con:value>${=(new Date()+18).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>returnDate</con:name><con:value>${=(new Date()+20).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>Valladolid-Palencia Codes</con:name><con:value>7110600,7114100</con:value></con:property><con:property><con:name>Barcelona-Paris Codes</con:name><con:value>BARCE,8700013</con:value></con:property></con:properties><con:reportParameters/></con:testSuite><con:testSuite id="25e43ce7-610b-432d-beb4-d5eb82bc23c9" name="TRENITALIA ACR WS"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="97732fdc-2e73-4b22-93e0-3e4d01747690" failOnError="false" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Search RT+OW diff cities" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="4e0fa8ad-a11c-478c-9231-dafb9b379fe4"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)


  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project


  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()

  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }</script></con:config></con:testStep><con:testStep type="request" id="11d180f3-f4e9-4b71-978f-a4e8b964bcfb" name="Single ROME-MILAN"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Single ROME-MILAN" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+2).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>MIL</destinationCode>
         </originDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="45824985-743f-4d0e-b587-7aa9fc4c4bd0" name="Round ROME-MILAN"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Round ROME-MILAN" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>MIL</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+6).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="79b2e161-567e-44f1-a73b-5e3ce855f5a7" name="Single ROME-TOURIN"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Single ROME-TOURIN" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+2).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>TRN</destinationCode>
         </originDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="e367c6ee-8f95-441a-8b47-2acaf109728b" name="Round ROME-TOURIN"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Round ROME-TOURIN" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>TRN</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+6).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="1523a76e-a1c0-4cfc-9c5c-909d3dfbee1b" name="Single ROME-NAPOLI"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Single ROME-NAPOLI" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+2).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>NAP</destinationCode>
         </originDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="39f697cb-9b27-4229-b105-21d8ee385432" name="Round ROME-NAPOLI"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Round ROME-NAPOLI" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>NAP</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+6).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>08:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="fa1e1f57-f1c3-4727-9dd5-d3c6e43bb25a" name="Single MILAN-VENICE remake request"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Single MILAN-VENICE remake request" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>MIL</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>VCE</destinationCode>
         </originDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="93fee75a-e6b2-4278-81b7-7e8954916632" name="Round MILAN-VENICE rename request"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Round MILAN-VENICE rename request" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>MIL</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>VCE</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+6).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="0db9fdac-9cd9-4531-8992-dffa9ae41981" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="PreBooking &amp; Cancel" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="71847648-2102-4564-850d-ad8613757870"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project


  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()

  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }</script></con:config></con:testStep><con:testStep type="request" id="0b893cda-fc4e-4ef6-a662-13169736e589" name="Рим-Милан"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="Рим-Милан" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date() +5).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>15:00</originTimeTo>
            <destinationCode>MIL</destinationCode>
         </originDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
             
               <additionalOptions>
               </additionalOptions>
            </passenger>
          
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journeys/journey[1]/journeyId,"[0-9]{4}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0b018c51-583a-4ed4-8732-b07ef8db0a19" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyInfo[1]/departureName,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="8d182e08-482f-4d50-9318-8452f460f912" name="XPath Match 2"><con:configuration><path>matches(//journeys/journey[1]/journeyInfo[1]/arrivalName,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="aa32da7c-1cbc-4039-9b13-7d2c4552deb5" name="Contains"><con:configuration><token>&lt;operatorName>Trenitalia&lt;/operatorName>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="88399269-f9f1-45a7-980c-5f6aa8e7bbb6" name="Contains 1"><con:configuration><token>&lt;trainCategory>Frecciarossa&lt;/trainCategory>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="6154be66-0bdb-47ba-a5f4-4d7072b6f646"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>Рим-Милан</con:sourceStep><con:sourcePath>//journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="a9471ccf-9536-4c18-b2ff-b1daeb6013ad" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8875</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="XPath Match" id="e0a19b1f-9978-4296-b3a6-4f6773ca81ad" name="XPath Match"><con:configuration><path>matches(//fareOffers//fareOffer[1]/netFare,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="c99f212c-1d36-4483-9f95-5cd5c8845801" name="XPath Match 1"><con:configuration><path>matches(//fareOffers/fareOffer[1]/fareRules,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="ff5b527c-f4bf-461c-8873-897160aa9bdd" name="XPath Match 2"><con:configuration><path>matches(//fareOffers/fareOffer[1]/fareName,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="18003169-ff5b-4c30-aa60-307fb44c3956" name="XPath Match 3"><con:configuration><path>matches(//fareOffers/fareOffer[1]/serviceClass,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="46119d96-b503-4d02-8057-fac8d87ea922" name="XPath Match 4"><con:configuration><path>matches(//fareOffers/fareOffer[1]/ticketOptions/ticketOption,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="e779707f-7ad5-404f-9ee3-e5805d1c730c"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId
</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="2d6349a4-18e7-4c0f-b0b8-59951aaf0287" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>69231</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <email>asd@ad.da</email>
               <birthDate>1990-01-01</birthDate>
            </passenger>
         </passengers>
         <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="ac5c115e-d8cb-4051-87c1-2808309f5fbb" name="Contains"><con:configuration><token>&lt;status>PR&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="XPath Match" id="d1ad5310-93fc-4999-81c4-037519357588" name="XPath Match 3"><con:configuration><path>matches(//fares/fare[1]/netFare,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="23fe03e8-46fc-402e-a924-2f26235959d0"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Cancel</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="6805b99f-47e7-4ea0-9980-75a3f3a5dfc3" name="acr_Cancel"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Cancel</con:operation><con:request name="acr_Cancel" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="6da5987b-4b1a-4ef6-8304-05b3970c49dd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Cancel>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>274</bookingId>
      </ns:acr_Cancel>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="9bbcb2b2-2b38-41b9-a386-97ac496fcdeb" name="SOAP Response"/><con:assertion type="XPath Match" id="52cc9f32-e216-420b-9d5f-5bbf65eb8dae" name="XPath Match"><con:configuration><path>matches(//booking/status, "XX")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Cancel"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="be7eb4f3-02c2-421a-9f23-16c3d2d686b6" failOnError="false" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="4f3244b1-2419-43d8-9168-28970034493e"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="60ab7cdd-0fbc-4654-9ac5-b0b2c7137578" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+5).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>MIL</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="515e443f-fb57-49c2-9e4e-3aefa68020d1"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="0105142a-8496-4a2c-b4f1-ddfa5e02a20f" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8948</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="00db0e98-8140-4f38-a755-844d73fdc84c"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="9e30c3b0-9877-45b0-9419-9ae36a3986ae"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId1</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBookingNEG_changePassCount</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId2</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBookingNEG_changePassBirthDate</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId3</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBookingNEG_NoSalutation</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="5e5a0094-7926-4306-8c43-e0a1cf28daf8" name="acr_PreBookingNEG_changePassCount"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBookingNEG_changePassCount" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>69935</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            </passengers>
          <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="cd530d02-b050-426d-bf9d-ef9b54219a61" name="Contains"><con:configuration><token>3603: Введены некорректные данные.</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="283788f2-cc43-4fa4-925d-7d261c6f7ac8" name="acr_PreBookingNEG_changePassBirthDate"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBookingNEG_changePassBirthDate" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>69935</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1991-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
           
            </passengers>
          <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="cd530d02-b050-426d-bf9d-ef9b54219a61" name="Contains"><con:configuration><token>3711: Даты рождения должны совпадать с датами рождения, введенными для поиска.</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="58648bdc-e63f-459b-98ce-c2cac76f464b" name="acr_PreBookingNEG_NoSalutation"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBookingNEG_NoSalutation" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>69935</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
           
            </passengers>
          <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="cd530d02-b050-426d-bf9d-ef9b54219a61" name="Contains"><con:configuration><token>2403: Некорректное обращение к пассажиру.</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" id="cbc47e45-b6db-4ab7-a606-695db7f65bc6" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>69943</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
          <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="d312628c-fc63-4229-9ff6-af193939a8fb"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="3280d4e7-dbbe-42ea-a387-33e180bc182b" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>275</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="925e744c-5d6f-4da6-a1a1-11ee2ef3a0c6" failOnError="false" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking_window" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="fa7f05ac-f798-41a4-bd96-ac2be65ff90b"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="c40e118c-44e9-455a-ba34-b9eeaa68b05f" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+2).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>MIL</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="a34d3b1b-6ee9-4bb0-a6b4-91dc8eca6e0f"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="c377463e-7c8c-4a7f-b62e-5f82c2781669" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8990</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="8508dab7-b3d7-4c9a-a5e1-eb9bba2f4fd3"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="d57417ba-95f4-4c99-b31d-a1d4702ada6b"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="fa7e0619-726a-437c-95d4-930914f6669d" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>70320</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
            <possiblePositions>window</possiblePositions>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
          <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="9df652b6-8205-4706-8da2-99407888da37"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="83908e6c-f9e2-4a7e-ac89-86926f0cbc4d" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>280</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="c5fb28fc-53f6-4ab8-91e9-db71052b2b77" failOnError="false" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking_aisle" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="580c755f-841a-4ee4-9f2e-60353991cb99"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="5179338e-e341-4a81-9989-ffa2be66ff33" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>MIL</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="98e23cac-060b-4a30-bb79-082320882dbd"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="23588ff6-5e5c-48e6-b236-aa0d225778ff" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>8984</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="e6343be0-b622-4869-843e-dce681e0304a"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="1ecc5af3-5936-47bf-8f5b-e4c7dc4a6700"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="8c79bfb7-4355-454e-b461-0be627c1d145" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>70224</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
            <possiblePositions>aisle</possiblePositions>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
              
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
          <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="c086b06b-3000-4366-b7b0-b52ab4dcd575"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="3086166d-2f6f-4164-9592-64e3ba1496a0" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>279</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="f2010132-7f14-4295-be58-812f946e03a5" failOnError="false" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking_middle" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="e02686c5-c018-451e-8c13-2c887f04a967"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="923192e2-fb0d-4c2e-b17b-31405fd7ba87" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>MIL</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="e8becee6-6c26-413c-a97f-cc2b9dce2fa7"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="1498431b-a402-4115-92ff-ea83b0fed536" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>9063</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="3ec280f2-ac7c-465e-ab0f-6a88638d62d2"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="844db66c-e15f-49e2-aa68-88b6f5b7778c"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="567339fb-fad9-48b4-b205-0e8e86bf3dc7" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>71032</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
            <possiblePositions>middle</possiblePositions>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
          <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="eb271d5a-e6da-4a82-8948-df2326d70518"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="d413731f-f284-4e31-8067-75e4e9c68646" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>283</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="b339509e-fbfe-4e4a-97aa-dc936a060647" failOnError="false" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking_window_single" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="de4e3e66-07c9-405c-81d6-1a5ba8da03c3"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="e77cffbb-78a8-44b5-b2b6-d029186622bc" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+2).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>MIL</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="d9bb257a-d938-445c-bf52-520b11ed7d29"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="b23195cc-602d-46f0-8a59-9a7484366fb1" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>9099</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="c3ca421d-c340-4a6d-9a71-566193993ed8"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="a45af8a2-68ac-4b2f-bbd4-2770fd1f23ef"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="26ccf695-829a-41fa-b952-c5d6b9aed635" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>71313</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
            <possiblePositions>window_single</possiblePositions>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
          <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="a3f3f50f-3efb-43c3-b3b3-3698e2d5e4f1"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="24feaa6b-8712-42f7-bac0-177e14b5e172" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>285</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="50a42f2d-d02c-4dd6-aeb0-0df50e4af465" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking &amp; Anulation" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="9152b2ad-eb5e-4a5c-9e2b-b6da58730c3f"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="9a47e957-f5b2-46dd-a958-969701a68e4e" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>MIL</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1930-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1960-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
             <passenger>
               <birthDate>1910-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="3bf05636-86f8-4ded-a677-fc05af232418"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="a90f100c-4d74-4cbe-956a-7489d545dd2f" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>9139</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="12f9e458-88ea-4361-9b6c-ad9e09553d9e"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="64c28b0c-06c4-4e3b-88b9-353ba91fcd47"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="83ae4554-5cd5-43b8-9870-f1f32ef6762b" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>71741</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>2</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameThird</name>
               <surname>TestSurnameThird</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>3</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameFourth</name>
               <surname>TestSurnameFourth</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>4</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameFifth</name>
               <surname>TestSurnameFifth</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>5</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSixst</name>
               <surname>TestSurnameSixst</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1930-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>6</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSeventh</name>
               <surname>TestSurnameSeventh</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>7</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameEight</name>
               <surname>TestSurnameEight</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1960-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            <passenger>
               <passengerId>8</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameNine</name>
               <surname>TestSurnameNine</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1910-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            </passengers>
          <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="f65a5168-f311-4cfb-8076-bfcd916dcbed"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="fbc530b7-5a2d-48a8-8a51-92391e52fb25" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>288</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer: bookingId" id="0699faac-03d9-4805-a861-fda69a40b740"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Booking</con:sourceStep><con:sourcePath>//bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Cancel</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="c31c6529-eae8-49b2-8083-55bd82ef6e41" name="acr_Cancel"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Cancel</con:operation><con:request name="acr_Cancel" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="6da5987b-4b1a-4ef6-8304-05b3970c49dd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Cancel>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>288</bookingId>
      </ns:acr_Cancel>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="9bbcb2b2-2b38-41b9-a386-97ac496fcdeb" name="SOAP Response"/><con:assertion type="XPath Match" id="52cc9f32-e216-420b-9d5f-5bbf65eb8dae" name="XPath Match"><con:configuration><path>matches(//booking/status, "XX")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Cancel"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="60aea446-6d9f-4fc3-9a64-01969c0b1c68" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking 2Adult+Child" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="cbab924f-3983-4ffa-b524-925a73f1fffc"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="0b8b3b41-793c-4dff-aec8-bd639b026f55" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>MIL</originCode>
            <originDate>${=(new Date()+5).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>ROM</destinationCode>
         </originDestinationSearch>
         <passengers>
          
             <passenger>
                
            </passenger>
           
              <passenger>
               <birthDate>2008-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            
             <passenger>
               
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="f86ee799-4cba-4b64-a832-036ff4390519"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="71cc870f-5341-496b-a31e-4ca8d0b3105e" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>9280</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="099922fb-67aa-44ea-a54b-1296a49fcfa2"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="c37429fa-8669-4097-8c91-aff79004eb93"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="0fd4bd15-63c7-40e0-9c90-da4ae5f51e69" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>72326</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameOne</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
            </passenger>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameTwo</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2008-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
            </passenger>
            <passenger>
               <passengerId>2</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameThree</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
            </passenger>
         </passengers>
         <contactDetails>
            <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="441aa1cf-fbac-43b6-a68f-4d1bd9e14066" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="d1b1db1e-aa3d-47e1-9bfb-c79ddc4e6323"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="2078e861-ff10-42c3-b4c8-54aad1660a8b" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>292</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="886fed2d-000d-48e7-8510-f5d49dd1e01e" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking &amp; Refund" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="c6468a65-ed98-44c9-a7cb-cd7f686f3954"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="0831b620-6144-40fa-a3c2-f8e6c45aabbd" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>MIL</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>VCE</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
           
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="6c899f03-8138-49ed-99b6-39b5352be82a"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"] and journeyInfo/ticketOptions[ticketOption="ETK"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="f127f356-32e4-4448-b07a-1d019ca17cf4" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>9359</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="e8df791e-ccb6-496e-a122-8d40caf17971"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="cf7d7228-d332-46d6-90f8-a620a3424919"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="083da940-d0ae-4821-ae90-20e9dd16926a" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>72832</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            
            </passengers>
        <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="e870903e-b03e-4b40-92a2-c624c46121e2"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="d89220e2-7f88-41e0-a0ad-d56e5a778633" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>293</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: bookingId" id="51e2d64e-5a95-496e-8ec4-8633356b8e75"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Booking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreRefund</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="delay" name="Delay 1" id="e01d698a-09bb-4cea-b89e-93a8e50309ef"><con:settings/><con:config><delay>3000</delay></con:config></con:testStep><con:testStep type="request" id="71b19ddb-ee69-4bed-b7e6-971cbffbf35a" name="acr_PreRefund"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreRefund</con:operation><con:request name="acr_PreRefund" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="3a17447d-e3f8-4d8a-af58-d05663d91db0"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreRefund>
        <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>293</bookingId>
      </ns:acr_PreRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="c792ccd7-6460-4db6-9881-5ac3877082ab" name="SOAP Response"/><con:assertion type="Simple Contains" id="f4f6dc35-7e24-4067-abf1-2d9d797e8627" name="Contains"><con:configuration><token>&lt;status>LO&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="XPath Match" id="db94a3cb-d093-4d05-9f51-fbbdfadb07b4" name="XPath Match"><con:configuration><path>matches(//refundTickets/refundTicket[1]/refundId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreRefund"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: refundId" id="8952011d-e6f2-4c9a-8f27-5a1794b33c9d"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreRefund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Refund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="b11aa060-fddb-42e6-86a4-91b0b712f2c3" name="acr_Refund"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Refund</con:operation><con:request name="acr_Refund" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="d53948c5-ac6f-4069-bdea-41ea51b4508e"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Refund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>62</refundId>
      </ns:acr_Refund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5721d579-08d7-4bbf-a04f-ebdeea6920d3" name="SOAP Response"/><con:assertion type="XPath Match" id="27f4b24d-d4e9-447f-9c38-9ff648199ab0" name="XPath Match"><con:configuration><path>matches(//return/refund/status, "OK")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Refund"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 3: refundId" id="43bef458-3961-4e71-80d9-36fbd4314af8"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Refund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetRefund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="8000e5ee-fe83-4d60-934e-677b1638008c" name="acr_GetRefund"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetRefund</con:operation><con:request name="acr_GetRefund" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="276edeeb-383f-44e6-9957-d8e9372e72d6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>62</refundId>
      </ns:acr_GetRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="16f0d6f2-40e4-4c5d-83ab-42a327488cc7" name="SOAP Response"/><con:assertion type="XPath Match" id="c94185e3-f986-436e-8e25-cc3cd0a0a7e4" name="XPath Match"><con:configuration><path>matches(//return/refund/status, "OK")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_GetRefund"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="10cd5fbf-e6f5-4f1b-a93f-7db2ba4dc033" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking &amp; Refund_Adult+Child" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="5365fddf-6672-47ce-a246-05928b679f0a"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="bcc8ed79-bd6f-4bba-bd8b-e5fee2804bdf" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>MIL</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>2010-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="46c6879d-3c84-40a5-8b16-a7f930b8fa89"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"] and journeyInfo/ticketOptions[ticketOption="ETK"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="5c624e3c-cea9-45a7-a347-c0363b9e1577" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>5700</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="Simple Contains" id="9adfa51e-7953-4b6a-85d8-73656969c7a5" name="Contains"><con:configuration><token>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="60e55a86-6e10-40b1-abc0-c4fcf34b98a3"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="df65ec69-f3bf-4b88-ae20-aacc4871ffa1"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="4d36d05a-404c-46ff-af82-f496900a3beb" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>42912</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2010-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            </passengers>
        <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="46b92f88-f8fc-441f-9b43-c23c390746ae" name="Contains"><con:configuration><token>&lt;status>PR&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="2c592785-20e4-47c5-8021-8a716a3e826a"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="ffacc7e4-2f61-4a40-a746-041c38bf0567" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>161</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="Simple Contains" id="c3476c74-49b1-44bd-a007-2bbf32cca4a8" name="Contains"><con:configuration><token>OK</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: bookingId" id="739eaf07-a5be-434f-b006-bb6e883d6cec"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Booking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreRefund</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="delay" name="Delay 1" id="c3aa8929-ad69-4982-8340-b346b64ec395"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" id="901aa38c-aa77-443a-bb41-a07334e2736d" name="acr_PreRefund"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreRefund</con:operation><con:request name="acr_PreRefund" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="3a17447d-e3f8-4d8a-af58-d05663d91db0"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreRefund>
        <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>161</bookingId>
      </ns:acr_PreRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="c792ccd7-6460-4db6-9881-5ac3877082ab" name="SOAP Response"/><con:assertion type="Simple Contains" id="57227a74-8e0e-420d-9fc8-de80be583979" name="Contains"><con:configuration><token>&lt;status>LO&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreRefund"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: refundId" id="c662c223-05ff-41d1-8051-393d8b3c2e01"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreRefund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Refund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="52cdba0a-b1ed-491c-be03-c3800a34d187" name="acr_Refund"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Refund</con:operation><con:request name="acr_Refund" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="d53948c5-ac6f-4069-bdea-41ea51b4508e"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Refund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>47</refundId>
      </ns:acr_Refund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5721d579-08d7-4bbf-a04f-ebdeea6920d3" name="SOAP Response"/><con:assertion type="XPath Match" id="27f4b24d-d4e9-447f-9c38-9ff648199ab0" name="XPath Match"><con:configuration><path>matches(//return/refund/status, "OK")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Refund"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 3: refundId" id="3bd6435b-0d37-49e3-b500-42b888c03826"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Refund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetRefund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="af527f7a-125a-4ae8-aa87-99c177efd5cb" name="acr_GetRefund"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetRefund</con:operation><con:request name="acr_GetRefund" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="276edeeb-383f-44e6-9957-d8e9372e72d6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>47</refundId>
      </ns:acr_GetRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="16f0d6f2-40e4-4c5d-83ab-42a327488cc7" name="SOAP Response"/><con:assertion type="XPath Match" id="c94185e3-f986-436e-8e25-cc3cd0a0a7e4" name="XPath Match"><con:configuration><path>matches(//return/refund/status, "OK")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_GetRefund"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="2af6f3a6-5b33-49a5-8212-ee39230c729c" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking 2Adult+ChildFree" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="4c0c1d1e-0498-4571-84d6-6068f1106b3d"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="a94b42b1-d8c8-4479-ae23-d1d86d0a9baa" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>MIL</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>ROM</destinationCode>
         </originDestinationSearch>
         <passengers>
          
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>  
            </passenger>
           
              
            
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions> 
            </passenger>

            <passenger>
               <birthDate>2015-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="a8143342-2efc-4493-b34b-d9c07512282d"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="f2676f55-ca52-4dc3-85cf-b851e9fb14f9" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>5780</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="02ecd7a6-0528-4ad0-8e5a-da9e23effda9"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="b3766bad-0e9c-4497-b5a3-bf0f41c7eb93"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="0501bb7f-eba9-42f0-85f1-862124d39624" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>43544</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameOne</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
            </passenger>
            
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameThree</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
            </passenger>
            <passenger>
               <passengerId>2</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameTwo</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2015-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
            </passenger>
         </passengers>
         <contactDetails>
            <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="441aa1cf-fbac-43b6-a68f-4d1bd9e14066" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="1aa5f9ad-7381-4f29-8c83-117230e45ef9"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="b20ac973-a5bb-4c3e-ae7e-3bbe3e627f51" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>167</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="b6f6bbba-1cf4-434e-ab5c-e6a72b9d0979" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking 2Adult+ChildFree+Child" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="956c8aea-046b-4340-852b-ef8bd0e4e2c6"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="1f82bd6c-ebd1-4759-9aaa-e7622ccd4a92" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>MIL</originCode>
            <originDate>${=(new Date()+2).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>ROM</destinationCode>
         </originDestinationSearch>
         <passengers>
          
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>  
            </passenger>
           
              <passenger>
               <birthDate>2015-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions> 
            </passenger>

               <passenger>
               <birthDate>2008-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>  
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="91d3fea2-ad66-462e-a96b-853e0718e375"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="59f590f4-1beb-4e2e-875f-8c79a5e537ef" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>5843</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="4eaf7820-e99e-4c3f-995b-2910ac22b0be"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="07bee504-cda1-4ff3-84e9-e8b3c91e32e0"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="d658aa9e-9930-44bb-bf91-8db85a10d61c" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>43788</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameOne</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
            </passenger>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameTwo</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2015-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
            </passenger>
            <passenger>
               <passengerId>2</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameThree</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
            </passenger>

            <passenger>
               <passengerId>3</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameFour</name>
               <surname>TestSurnameFour</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2008-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
            </passenger>
         </passengers>
         <contactDetails>
            <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="441aa1cf-fbac-43b6-a68f-4d1bd9e14066" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="157d343e-77d9-4a96-9964-987ca55c2f7a"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="79b6b7c6-4d81-4e99-a598-356e02f51581" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>169</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="9aa8f3ed-ee89-4b9b-baa2-d4e0eed02c0d" failOnError="false" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking&amp;Coupone" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="cb71e0e7-0523-4224-af2a-3fa07c185957"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="9109fd49-2373-4971-9dbe-be3a319e6bfe" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+2).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>MIL</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="ae24bb3e-6134-49fb-84cc-161f30845445"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="c17d74a7-e3ba-4d4c-b9e5-b4d5c346a523" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>5913</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="bac6ee3b-1d99-41dd-a530-850386676c47"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="e99dc845-2132-4e4c-8f92-60858781b93d"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="c01e8f90-b0ba-44a0-8193-d1761dec09fb" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>44398</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
          <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="8ed43044-7e0e-42ba-9a0f-5cb7a324fa2b"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="4b2fe99e-b608-4e08-8477-38649b1de781" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>171</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: boukingId" id="2db25234-1428-474a-8d36-aa48d59b3ee0"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetBooking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="delay" name="Delay" id="0e4c54ab-3226-4e23-8548-59fc756f3411"><con:settings/><con:config><delay>120000</delay></con:config></con:testStep><con:testStep type="request" id="088b8210-39bb-4cf1-b320-fafce8f2b4b0" name="acr_GetBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetBooking</con:operation><con:request name="acr_GetBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="418d456e-8385-4bd5-8512-a8d239b06f79"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>171</bookingId>
      </ns:acr_GetBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2be17077-0305-4b2a-9b4e-4e3614d4b7ff" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_GetBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Coupon: coupon" id="6c7c996f-4b0d-4e10-ac64-196a6a4beb66"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_GetBooking</con:sourceStep><con:sourcePath>//coupons/coupon/couponId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetCoupons</con:targetStep><con:targetPath>//couponId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="9d08521b-ccb7-491c-921f-3fc7d0f63865" name="acr_GetCoupons"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetCoupons</con:operation><con:request name="acr_GetCoupons" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="13fed1c3-92df-40d7-ab19-5a004ab9eb8b"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetCoupons>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <coupons>
            <!--Zero or more repetitions:-->
            <coupon>
               <!--You may enter the following 2 items in any order-->
               <couponId/>
               <couponPdf>true</couponPdf>
            </coupon>
         </coupons>
      </ns:acr_GetCoupons>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="afb5cb0a-23ac-4d6d-8f9a-d57100e31da8" name="SOAP Response"/><con:assertion type="XPath Match" id="d6c5f1c7-707a-4dc8-b19b-0729e59ea05a" name="XPath Match"><con:configuration><path>exists(//coupons/coupon/couponPdf)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_GetCoupons"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="f686e607-ffca-44e2-be1b-b4ae5f2bc19a" failOnError="false" failTestCaseOnErrors="false" keepSession="false" maxResults="0" name="Roundtrip Book &amp; Coupon 2 pass" searchProperties="true" timeout="120000" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="properties" name="Properties of search" id="7d149796-509d-440a-8d0a-3326bbe6805e"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>date of travel</con:name><con:value>${=(new Date()+10).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>Departure</con:name><con:value>ROM</con:value></con:property><con:property><con:name>Destination</con:name><con:value>MIL</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer" id="99945548-48bf-4c0f-bedf-784014a1314c"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>search</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>search</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>search</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script: set endpoint" id="3e61d35d-f7d7-4a13-999f-3f82cd0c7b7f"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }</script></con:config></con:testStep><con:testStep type="request" id="766a591d-d31c-43d9-832d-c66f06d5e347" name="search"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="search" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+10).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>MIL</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+12).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="c44bf8fc-6563-444b-8fe8-75747929fd69" name="XPath Match 2"><con:configuration><path>matches(//roundtripJourneys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyIdRT" id="caa2c660-dfb8-478d-b3b9-9334e39345a0"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>search</con:sourceStep><con:sourcePath>//journeys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyRoundtrip</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>search</con:sourceStep><con:sourcePath>//roundtripJourneys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//roundtripJourneyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="0b0f4afb-61bb-460a-8e28-2eb6ee3cc2d5" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>5970</journeyId>
         <roundtripJourneyId>5976</roundtripJourneyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="XPath Match" id="5a4db4d5-441e-4d1f-8c67-881f6631ea49" name="XPath Match"><con:configuration><path>matches(//fareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="05fa72d9-2e99-43bd-8ca6-b879ce635dc4" name="XPath Match 1"><con:configuration><path>matches(//roundtripFareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferIdRT" id="9709a68f-73de-478b-a7f5-af0fd044a923"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>ticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//bookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTfareOffer</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers//fareOffer[fareName="Base"]//fareOfferId[last()]</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripFareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripBookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="630bf69f-3345-4627-a7aa-b4e87b425521" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <fareOfferId>44968</fareOfferId>
         <roundtripFareOfferId>45040</roundtripFareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <roundtripBookingRequest>
            <!--You may enter the following 19 items in any order-->
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </roundtripBookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>yy@xx.xx</email>
            </passenger>
         </passengers>
        <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="95e41069-f647-4578-a061-6b0b28f1a30d" name="Contains"><con:configuration><token> &lt;status>PR&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="d9bc5680-a016-4258-8877-bbf47d80da09"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="f88f70ee-27e5-493f-8e32-1dcba084ba15" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>176</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="c08d7fce-2fab-4cc9-b124-e80597906695"><con:settings/><con:config><delay>120000</delay></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: boukingId" id="54656b2a-8db1-4fc6-a8b0-d99c5d3ecd41"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetBooking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="148d4e41-c478-40c6-b5f7-cf31514bffde" name="acr_GetBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetBooking</con:operation><con:request name="acr_GetBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="418d456e-8385-4bd5-8512-a8d239b06f79"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>12457</bookingId>
      </ns:acr_GetBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2be17077-0305-4b2a-9b4e-4e3614d4b7ff" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_GetBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Coupon: coupon" id="3fbb5d34-b404-4e4a-8d6f-2f99519d4ec3"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_GetBooking</con:sourceStep><con:sourcePath>//coupons/coupon/couponId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetCoupons</con:targetStep><con:targetPath>//couponId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="6f60e528-a937-447f-9d56-7e34f16ee7f8" name="acr_GetCoupons"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetCoupons</con:operation><con:request name="acr_GetCoupons" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="13fed1c3-92df-40d7-ab19-5a004ab9eb8b"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetCoupons>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <coupons>
            <!--Zero or more repetitions:-->
            <coupon>
               <!--You may enter the following 2 items in any order-->
               <couponId/>
               <couponPdf>true</couponPdf>
            </coupon>
         </coupons>
      </ns:acr_GetCoupons>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="afb5cb0a-23ac-4d6d-8f9a-d57100e31da8" name="SOAP Response"/><con:assertion type="XPath Match" id="d6c5f1c7-707a-4dc8-b19b-0729e59ea05a" name="XPath Match"><con:configuration><path>exists(//coupons/coupon/couponPdf)</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_GetCoupons"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>searchCounter</con:name><con:value>0</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="241f9ab6-2c55-4a18-8468-1bbf409f2967" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Roundtrip Book &amp; Refund" searchProperties="true" timeout="120000" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="properties" name="Properties of search" id="9bf1372c-6a48-42db-a65e-08f5f24c4c2b"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>date of travel</con:name><con:value>${=(new Date()+4).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>Departure</con:name><con:value>ROM</con:value></con:property><con:property><con:name>Destination</con:name><con:value>MIL</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer" id="8877006d-0341-4234-ba90-84eeeec7d3b4"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>search</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>search</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>search</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script: set endpoint" id="4239b5f6-a8c4-4d44-aac8-fee3e99d5992"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }</script></con:config></con:testStep><con:testStep type="request" id="e25faa8d-0d90-4abf-b227-715fbcb8d27c" name="search"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="search" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>MIL</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+6).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="c44bf8fc-6563-444b-8fe8-75747929fd69" name="XPath Match 2"><con:configuration><path>matches(//roundtripJourneys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyIdRT" id="275e8f2a-3976-4b85-9ba4-e93a921a887c"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>search</con:sourceStep><con:sourcePath>//journeys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyRoundtrip</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>search</con:sourceStep><con:sourcePath>//roundtripJourneys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//roundtripJourneyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="b943dc98-8552-4873-ae2e-27f331696006" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>6084</journeyId>
         <roundtripJourneyId>6090</roundtripJourneyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="XPath Match" id="5a4db4d5-441e-4d1f-8c67-881f6631ea49" name="XPath Match"><con:configuration><path>matches(//fareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="05fa72d9-2e99-43bd-8ca6-b879ce635dc4" name="XPath Match 1"><con:configuration><path>matches(//roundtripFareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferIdRT" id="6645d3a3-1d65-4f91-996d-25e9dca78a96"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>ticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//bookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTfareOffer</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers//fareOffer[fareName="Base"]//fareOfferId[last()]</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripFareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripBookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="dd5e1355-377d-48ed-b617-ae5471c7d5c1" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <fareOfferId>46069</fareOfferId>
         <roundtripFareOfferId>46165</roundtripFareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <roundtripBookingRequest>
            <!--You may enter the following 19 items in any order-->
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </roundtripBookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>yy@xx.xx</email>
            </passenger>
         </passengers>
        <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="944d7fe6-0c58-4d9e-ad55-8fed3ba5a8b7" name="Contains"><con:configuration><token> &lt;status>PR&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="f3cd823a-c903-458a-bac4-b6d36a1e4f10"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="36c33d5e-cad2-4df9-941a-341af5bb5a65" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>178</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="Simple Contains" id="394f962b-55c6-4851-b61a-b5467a1309fc" name="Contains"><con:configuration><token>OK</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: boukingId" id="aae2a888-6386-4555-a7ae-e8edaec37bd4"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreRefund</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="delay" name="Delay" id="c687186c-20d0-41d2-b68b-6ffc6e6e597e"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="acr_PreRefund" id="3088578d-ee06-4e76-a0c8-5bee0e3b1d53"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreRefund</con:operation><con:request name="acr_PreRefund" id="c2b85959-20ae-4eb4-b694-12ab465cf1b0"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>178</bookingId>
      </ns:acr_PreRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ba8a8717-8338-4366-b43e-4a198e8e43f1"/><con:assertion type="Simple Contains" id="9f61e46f-112d-4871-b001-0e104a0c73d4" name="Contains"><con:configuration><token> &lt;status>LO&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: refundId" id="35c7d173-8298-4975-a1bd-269b3ed6ba20"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreRefund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Refund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" name="acr_Refund" id="24cbdcec-622d-4c3f-abb1-520d1f250972"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Refund</con:operation><con:request name="acr_Refund" id="8a10b4b6-00c1-46d6-a079-de318274da5d"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Refund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <refundId>52</refundId>
      </ns:acr_Refund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8b06932-dcc6-4db4-a1ba-8c30a84a72a4"/><con:assertion type="Simple Contains" id="11c35106-3db2-4dca-98cb-beb5e1d793ef" name="Contains"><con:configuration><token>  &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer 3: refundId" id="71544220-62d8-4f33-aed4-4c3b94498cb2"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Refund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetRefund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" name="acr_GetRefund" id="eb8a3159-56f6-42de-9ab7-e03d7775692c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetRefund</con:operation><con:request name="acr_GetRefund" id="ea4cb7d1-6551-4833-8e1e-8b90bf6cec60"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>52</refundId>
      </ns:acr_GetRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="50cac8a7-bd47-4b3b-b295-4886e23c9777"/><con:assertion type="Simple Contains" id="e1b6d5c5-a540-4b52-a205-8611225c4e2b" name="Contains"><con:configuration><token>OK</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>searchCounter</con:name><con:value>0</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="17468af0-1668-462c-a1bb-657971c5a667" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Roundtrip Book &amp; Refund_Adult+Child" searchProperties="true" timeout="120000" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="properties" name="Properties of search" id="aa25894c-23c5-4536-a8a2-c2bd3fd18b55"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>date of travel</con:name><con:value>${=(new Date()+3).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>Departure</con:name><con:value>ROM</con:value></con:property><con:property><con:name>Destination</con:name><con:value>MIL</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer" id="7b7af616-5718-416c-884e-d582096a8198"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>search</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>search</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>search</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script: set endpoint" id="77662595-61e3-4a18-b038-9f9074b76d1d"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }</script></con:config></con:testStep><con:testStep type="request" id="121de5bb-05ad-4432-83b9-3fc245a648a2" name="search"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="search" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>MIL</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+6).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               
            </passenger>
            <passenger>
               <birthDate>2010-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="c44bf8fc-6563-444b-8fe8-75747929fd69" name="XPath Match 2"><con:configuration><path>matches(//roundtripJourneys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyIdRT" id="5a3c2666-abe8-48d1-a741-459414ade56b"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>search</con:sourceStep><con:sourcePath>//journeys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyRoundtrip</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>search</con:sourceStep><con:sourcePath>//roundtripJourneys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//roundtripJourneyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="c0ba95f6-0f64-4dbd-933c-86294e74d654" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>6147</journeyId>
         <roundtripJourneyId>6153</roundtripJourneyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="XPath Match" id="5a4db4d5-441e-4d1f-8c67-881f6631ea49" name="XPath Match"><con:configuration><path>matches(//fareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="05fa72d9-2e99-43bd-8ca6-b879ce635dc4" name="XPath Match 1"><con:configuration><path>matches(//roundtripFareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferIdRT" id="16774e65-293c-44e4-9a10-f8f0c2224b68"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>ticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//bookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTfareOffer</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers//fareOffer[fareName="Base"]//fareOfferId[last()]</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripFareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripBookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="495c17da-16d1-4425-80a8-63b89b586b20" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <fareOfferId>46724</fareOfferId>
         <roundtripFareOfferId>46846</roundtripFareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <roundtripBookingRequest>
            <!--You may enter the following 19 items in any order-->
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </roundtripBookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2010-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>yy@xx.xx</email>
            </passenger>
         </passengers>
        <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="701df9a9-bbcb-481a-976b-462d349bd4dd"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="171dc5c1-7031-4fa8-9269-480f046a7d2b" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>180</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: boukingId" id="dd3b4e5d-238b-4130-8304-ed35c5f851d9"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreRefund</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="delay" name="Delay" id="7cec2fd0-c0c2-4f82-9ed5-c58f8111ac6f"><con:settings/><con:config><delay>3000</delay></con:config></con:testStep><con:testStep type="request" name="acr_PreRefund" id="325d7e58-eb3f-4c5e-8d97-9280c3ae38d3"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreRefund</con:operation><con:request name="acr_PreRefund" id="c2b85959-20ae-4eb4-b694-12ab465cf1b0"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>180</bookingId>
      </ns:acr_PreRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ba8a8717-8338-4366-b43e-4a198e8e43f1"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: refundId" id="1620394b-4760-4863-8a01-f6f2005d6444"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreRefund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Refund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" name="acr_Refund" id="087a6aef-eba2-484d-97d0-d1590021ce26"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Refund</con:operation><con:request name="acr_Refund" id="8a10b4b6-00c1-46d6-a079-de318274da5d"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Refund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <refundId>54</refundId>
      </ns:acr_Refund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8b06932-dcc6-4db4-a1ba-8c30a84a72a4"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer 3: refundId" id="b0372c27-0565-4106-82ee-36b60849bd25"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Refund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetRefund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" name="acr_GetRefund" id="6d236194-644c-4396-9907-748d3c209309"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetRefund</con:operation><con:request name="acr_GetRefund" id="ea4cb7d1-6551-4833-8e1e-8b90bf6cec60"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>54</refundId>
      </ns:acr_GetRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="50cac8a7-bd47-4b3b-b295-4886e23c9777"/><con:assertion type="Simple Contains" id="8b8193dc-792b-48e4-8260-569e2691eb50" name="Contains"><con:configuration><token>&lt;status>OK&lt;/status></token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>searchCounter</con:name><con:value>0</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="200da6ad-6f23-4f65-9a02-ab44fa211349" failOnError="false" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking Night Train T3 Sleeper MR" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="045b0897-6220-4bc5-acbe-92f0b553a466"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="ab43ff72-ad03-4bd7-90f5-fa812fea67b5" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>MIL</originCode>
            <originDate>${=(new Date()+1).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>21:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>ROM</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="8c6ff614-30b0-4d3a-a750-2e3ed75aa62f"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment/trainNumber="797"]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="8fa50ad2-0ab5-4a16-a013-7d43661f1b64" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>6210</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="cda3aa18-510a-4ded-9ec9-e7b91bc609b0"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="8079a3d9-44ef-44a0-a25c-f08f550f426b"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[serviceClass="2nd Class T3 Sleeper" and  fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="d0fd2546-a4bb-48ac-9945-b3cc149cf714" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>47418</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
            <genderCoupe>female</genderCoupe>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Ms</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
         <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="c7e06438-0bd5-4c67-a303-e6265587a963"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="a7332ed0-79fa-482a-9bd3-f0d84c392fc9" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>182</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="104a02e6-0e55-4787-bac9-0a0aa3b05584" failOnError="false" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking Night Train T3 Sleeper Gengder NEG" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="f253de15-8456-4ab5-a503-7d590e9a02c0"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="b2a9459f-7014-4618-8320-4fba05ee30b7" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>MIL</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>21:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>ROM</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="ea9af816-44ca-491e-8271-354d46619b37"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment/trainNumber="797"]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="32580426-7bc5-4c07-b898-8d6f649747e9" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>6216</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="2ccc0f50-1120-4d0e-87ad-8a245fc5abab"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="09973c9e-4911-4589-8e24-278ccaa1327a"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[serviceClass="2nd Class T3 Sleeper" and  fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="81115698-f754-470f-b128-0cfe31af0f77" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>47505</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
            <genderCoupe>female</genderCoupe>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
         <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="Simple Contains" id="c5610d9d-c8bb-4027-9d27-627135951804" name="Contains"><con:configuration><token> &lt;faultstring>2204: Passenger gender should correspond to selected coupe type&lt;/faultstring>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="28754127-de69-4022-b8b4-3c9464e8b2a7" failOnError="false" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="defect 1241 Booking Night Train Single Spec Sleeper" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="072e1edd-6e48-403a-b77e-5532f162e08d"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="0b7711b5-9465-4a64-a878-161338407d91" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>MIL</originCode>
            <originDate>${=(new Date()+4).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>21:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>ROM</destinationCode>
         </originDestinationSearch>
         <passengers>
            <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="f76ab467-4f8f-4215-8b7f-6228527a47fb"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment/trainNumber="35767"]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="4bc1cc67-c9a4-414c-9211-76a5e018cdbd" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId/>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="bac149bd-5065-4dcf-8a91-158b89c192e3"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="2fbf232d-2ed6-4f81-ba91-2f1a854c5432"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[serviceClass="1st Class Single Special Sleeper" and  fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="dd2d0713-711b-4ada-ab00-92c1300f9b6d" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId/>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
             </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Ms</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>               
            </passenger>
            
            </passengers>
         <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="49f19d21-57b5-41ca-8ba2-56ca78f9efc9"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="e61f3e35-e0f0-4ef6-a084-ef0e4f27be6e" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId/>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="8fa70500-4c70-4ca3-a4f2-dee067cca7e3" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Roundtrip Book &amp; Refund_Adult+Child+ChildFree" searchProperties="true" timeout="120000" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="properties" name="Properties of search" id="24ca72bd-a788-4afe-bf82-d614d3f7ea58"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>date of travel</con:name><con:value>${=(new Date()+10).format('yyyy-MM-dd')}</con:value></con:property><con:property><con:name>Departure</con:name><con:value>ROM</con:value></con:property><con:property><con:name>Destination</con:name><con:value>MIL</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer" id="388c5856-f1b5-4a4a-bcbb-14dc741e3c1b"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>date</con:name><con:sourceType>date of travel</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:sourcePath/><con:targetType>Request</con:targetType><con:targetStep>search</con:targetStep><con:targetPath>//originDestinationSearch/originDate</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>departure</con:name><con:sourceType>Departure</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>search</con:targetStep><con:targetPath>//originDestinationSearch/originCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>destination</con:name><con:sourceType>Destination</con:sourceType><con:sourceStep>Properties of search</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>search</con:targetStep><con:targetPath>//originDestinationSearch/destinationCode</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script: set endpoint" id="8f832893-7cd7-4559-882c-2c0d41ffd12f"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }</script></con:config></con:testStep><con:testStep type="request" id="b9c108e4-29f2-4686-9789-01a620f76938" name="search"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="search" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>ROM</originCode>
            <originDate>${=(new Date()+10).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>MIL</destinationCode>
         </originDestinationSearch>
         <roundtripOriginDestinationSearch>
            <!--You may enter the following 3 items in any order-->
            <originDate>${=(new Date()+20).format('yyyy-MM-dd')}</originDate>
		  <originTimeFrom>12:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
         </roundtripOriginDestinationSearch>
         <passengers>
               <passenger>
               
            
            </passenger>
            <passenger>
               <birthDate>2010-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
              <passenger>
               <birthDate>2016-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="675e9320-9b31-48dc-bfbf-956a309f879c" name="XPath Match"><con:configuration><path>matches(//journeys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="c44bf8fc-6563-444b-8fe8-75747929fd69" name="XPath Match 2"><con:configuration><path>matches(//roundtripJourneys/journey[1]/journeyId, "[0-9]{1,5}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyIdRT" id="09cdfb2c-bbf5-4ab4-bc91-f89a0a512abf"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>search</con:sourceStep><con:sourcePath>//journeys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyRoundtrip</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>search</con:sourceStep><con:sourcePath>//roundtripJourneys/journey[1]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>//roundtripJourneyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="0e7db270-25c6-47eb-86fe-46882ff157b8" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>6228</journeyId>
         <roundtripJourneyId>6234</roundtripJourneyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:assertion type="XPath Match" id="5a4db4d5-441e-4d1f-8c67-881f6631ea49" name="XPath Match"><con:configuration><path>matches(//fareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="05fa72d9-2e99-43bd-8ca6-b879ce635dc4" name="XPath Match 1"><con:configuration><path>matches(//roundtripFareOffers/fareOffer[1]/fareOfferId, "[0-9]{1,10}")</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferIdRT" id="72ab9962-9f51-439b-8871-4670ae4a5154"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>ticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//bookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTfareOffer</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers//fareOffer[fareName="Base"]//fareOfferId[last()]</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripFareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>RTticketOption</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//roundtripFareOffers/fareOffer[1]/ticketOptions/ticketOption</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//roundtripBookingRequest/ticketOption</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="32bfe564-6e9c-4eae-8222-2e6d7808e55c" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <fareOfferId>47695</fareOfferId>
         <roundtripFareOfferId>47787</roundtripFareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <roundtripBookingRequest>
            <!--You may enter the following 19 items in any order-->
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </roundtripBookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestName</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>zz@xx.xx</email>
            </passenger>
            <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameSec</name>
               <surname>TestSurnameSec</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2010-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>yy@xx.xx</email>
            </passenger>
             <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameThird</name>
               <surname>TestSurnameThird</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2016-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
               <email>yy@xx.xx</email>
            </passenger>
         </passengers>
        <contactDetails>
         <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="da0c60f7-d8fd-438b-a38d-3abf7734206c"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="fd6eef0d-e936-4dcb-beee-bedeff1bbf88" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>183</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: boukingId" id="16843d92-a2b0-4878-986a-8620bc500601"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreRefund</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="delay" name="Delay" id="5d3eeb25-c2c0-41aa-bf2b-951ce151f1e7"><con:settings/><con:config><delay>3000</delay></con:config></con:testStep><con:testStep type="request" name="acr_PreRefund" id="87ca76f2-bb68-45d8-b453-e889355d1112"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreRefund</con:operation><con:request name="acr_PreRefund" id="c2b85959-20ae-4eb4-b694-12ab465cf1b0"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>183</bookingId>
      </ns:acr_PreRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ba8a8717-8338-4366-b43e-4a198e8e43f1"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer 2: refundId" id="00e18b29-b537-4916-9e3e-47f38a23595b"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreRefund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Refund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" name="acr_Refund" id="cb5f10f2-786c-4349-aecb-71eb56cf5a8a"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Refund</con:operation><con:request name="acr_Refund" id="8a10b4b6-00c1-46d6-a079-de318274da5d"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Refund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <refundId>56</refundId>
      </ns:acr_Refund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8b06932-dcc6-4db4-a1ba-8c30a84a72a4"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer 3: refundId" id="e6c9c4ec-1458-4f5f-a178-eaa04ffc4cc4"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="false"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_Refund</con:sourceStep><con:sourcePath>//refund/refundId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_GetRefund</con:targetStep><con:targetPath>//refundId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" name="acr_GetRefund" id="74774166-59ee-4bfa-a30c-f9c43f925bac"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_GetRefund</con:operation><con:request name="acr_GetRefund" id="ea4cb7d1-6551-4833-8e1e-8b90bf6cec60"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="https://acr.localhost/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_GetRefund>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <refundId>56</refundId>
      </ns:acr_GetRefund>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="50cac8a7-bd47-4b3b-b295-4886e23c9777"/><con:assertion type="Simple Contains" id="9f361e31-725d-4529-ab29-d2a3ae2efe5b" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status></token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>searchCounter</con:name><con:value>0</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="97dccb03-d4f4-41dc-b976-308c72bb74cb" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Booking Adult+ChildFree+Adult" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Groovy Script: set endpoint" id="8d2ea864-18e6-4b38-b7ab-58f7da7522e1"><con:settings/><con:config><script>String endP = testRunner.testCase.testSuite.project.getPropertyValue("endpointForWork")
  log.info endP
  // Get the list of test steps
  def allTestSteps = testRunner.testCase.getTestStepsOfType(com.eviware.soapui.impl.wsdl.teststeps.WsdlTestRequestStep.class)

  // Set each of test steps endpoint from property endpointWork
  for (int i = 0;i&lt;allTestSteps.size();i++){
  allTestSteps[i].getHttpRequest().setEndpoint(endP)
  }


  // Change the access credentials for all request
  def values = testRunner.testCase.testSuite.project.getPropertyValue("resellerForWork").split(',')
  String resellerCode = values[0]
  log.info resellerCode
  String userName = values[1]
  log.info userName
  String password = values[2]
  log.info password

  def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
  def project = context.testCase.testSuite.project

  for (int i = 0;i&lt;allTestSteps.size();i++){
  def teststepname = allTestSteps[i].getName().toString()
  String inputHolder = teststepname + "#Request"
  log.info inputHolder
  def holderRawReq = groovyUtils.getXmlHolder(inputHolder)
  holderRawReq.setNodeValue("//access/resellerCode", resellerCode)
  holderRawReq.setNodeValue("//access/userName", userName)
  holderRawReq.setNodeValue("//access/password", password)
  holderRawReq.updateProperty()
  }

  //Setup default number of offerSearch
  testRunner.testCase.setPropertyValue( "offerNumber", "1")</script></con:config></con:testStep><con:testStep type="request" id="30005f6b-673d-4bce-b516-3b4a919bf096" name="acr_JourneySearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_JourneySearch</con:operation><con:request name="acr_JourneySearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="15dc3084-d3e2-4aef-9272-1bc33571b2bd"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="XDEBUG_SESSION" value="PHPSTORM" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_JourneySearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>en</lang>
         </access>
         <originDestinationSearch>
            <!--You may enter the following 5 items in any order-->
            <originCode>MIL</originCode>
            <originDate>${=(new Date()+3).format('yyyy-MM-dd')}</originDate>
            <originTimeFrom>00:00</originTimeFrom>
            <originTimeTo>23:59</originTimeTo>
            <destinationCode>ROM</destinationCode>
         </originDestinationSearch>
         <passengers>
          
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>  
            </passenger>
           
               <passenger>
               <birthDate>2015-01-01</birthDate>
               <additionalOptions>
               </additionalOptions>
            </passenger>
            
             <passenger>
               <birthDate>1990-01-01</birthDate>
               <additionalOptions>
               </additionalOptions> 
            </passenger>

           
         </passengers>
      </ns:acr_JourneySearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="eb363df6-ff3b-43fe-9dde-0ef9567c25cc" name="Search @journeyId@"><con:configuration><path>matches(//journey/journey[0]/journeyId,"[0-9]{5}")</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_JourneySearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: journeyId" id="6a87af42-b273-4981-9f08-983288b85823"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>journeyId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_JourneySearch</con:sourceStep><con:sourcePath>//journeys/journey[journeySegments/journeySegment[transportType="train"]][${#TestCase#offerNumber}]/journeyId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_FareOfferSearch</con:targetStep><con:targetPath>declare namespace soap='http://schemas.xmlsoap.org/soap/envelope/';
  declare namespace ns1='http://dev.acr.local/ws/SoapApi/0.1/';
  //journeyId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="92794275-45a4-471a-bccd-5947c96ce46c" name="acr_FareOfferSearch"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_FareOfferSearch</con:operation><con:request name="acr_FareOfferSearch" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="2db85c6f-cbec-4f60-99cc-e7825dabcfae"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_FareOfferSearch>
         <access>
            <!--You may enter the following 4 items in any order-->
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <journeyId>6291</journeyId>
      </ns:acr_FareOfferSearch>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="892446ee-3548-4294-b2f3-f1c8164858d2" name="SOAP Response"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_FareOfferSearch"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="86309e18-8dd6-4505-8650-e9cac1efac59"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
  def holder = groovyUtils.getXmlHolder ("acr_FareOfferSearch#Response")

  String status = holder.getNodeValue("//faultstring")

  int num = testRunner.testCase.getPropertyValue( "offerNumber").toInteger()
  num = num+1

  if("3712: Нет доступных мест нужной категории по данному тарифу.".equals(status)) {
  testRunner.testCase.setPropertyValue( "offerNumber", num.toString())
  testRunner.gotoStepByName( "Property Transfer: journeyId" )
  }
  else log.info "false"
</script></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: fareOfferId" id="d3a39602-271a-4677-9827-90b4bc74635b"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>fareOfferId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_FareOfferSearch</con:sourceStep><con:sourcePath>//fareOffers/fareOffer[fareName="Base"]/fareOfferId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_PreBooking</con:targetStep><con:targetPath>//fareOfferId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="b8e05166-5d2a-4275-b81c-e4e17d8c2739" name="acr_PreBooking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_PreBooking</con:operation><con:request name="acr_PreBooking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="af6c289d-1d97-47aa-8181-13807baf05bf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_PreBooking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <fareOfferId>48033</fareOfferId>
         <bookingRequest>
            <ticketOption>ETK</ticketOption>
            <paymentType>WIRE</paymentType>
         </bookingRequest>
         <passengers>
            <passenger>
               <passengerId>0</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameOne</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
            </passenger>
             <passenger>
               <passengerId>1</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameTwo</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>2015-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
            </passenger>
            <passenger>
               <passengerId>2</passengerId>
               <salutation>Mr</salutation>
               <name>TestNameThree</name>
               <surname>TestSurname</surname>
               <patronymic>Test</patronymic>
               <documentType>AD</documentType>
               <documentNumber>1234567</documentNumber>
               <birthDate>1990-01-01</birthDate>
               <birthPlace>Kiev</birthPlace>
               <nationality>UA</nationality>
               <residence>UA</residence>
            </passenger>
           
         </passengers>
         <contactDetails>
            <email>oleksii.osinskyi@amadeus.com</email>
         </contactDetails>
      </ns:acr_PreBooking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="649cae9a-3cfb-42ed-a290-b2c160ae6935" name="SOAP Response"/><con:assertion type="SOAP Fault Assertion" id="441aa1cf-fbac-43b6-a68f-4d1bd9e14066" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_PreBooking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer: bookingId" id="47a5cb4c-93a5-4bf1-b3a8-9134a7e7ab96"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="false" ignoreEmpty="false" transferToAll="true" entitize="false" transferChildNodes="true"><con:name>bookingId</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>acr_PreBooking</con:sourceStep><con:sourcePath>//booking/bookingId</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>acr_Booking</con:targetStep><con:targetPath>//bookingId</con:targetPath><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="request" id="8c33fc99-f03a-44d6-a9dc-e61dbe8502f2" name="acr_Booking"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SoapApiBinding</con:interface><con:operation>acr_Booking</con:operation><con:request name="acr_Booking" outgoingWss="" incomingWss="" timeout="" sslKeystore="" useWsAddressing="false" useWsReliableMessaging="false" wssPasswordType="" id="daa6a19f-c9b6-4758-8ef8-293e071040c1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://dev.amr.local/app_dev.php/ws/SoapApi</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://dev.acr.local/ws/SoapApi/0.1/">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:acr_Booking>
         <access>
            <resellerCode>as-ws</resellerCode>
            <userName>as-ws</userName>
            <password>Test123!</password>
            <lang>ru</lang>
         </access>
         <bookingId>187</bookingId>
      </ns:acr_Booking>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2e73c43a-ab52-4d4b-bb15-a4a9c60d31ad" name="SOAP Response"/><con:assertion type="XPath Match" id="5ab2ecf3-5805-41cb-bc06-c4c8e7683910" name="XPath Match"><con:configuration><path>matches(//booking/operatorBookingId,'.')</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="f56dc19e-b88b-4f40-bfcd-af044a38af3f" name="Contains"><con:configuration><token> &lt;status>OK&lt;/status>
</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://dev.acr.local/ws/SoapApi/0.1/acr_Booking"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>offerNumber</con:name><con:value>1</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:properties/></con:testSuite><con:properties><con:property><con:name>endpointForWork</con:name><con:value>https://dev.amr.local/ws/SoapApi</con:value></con:property><con:property><con:name>resellerForWork</con:name><con:value>as-ws,as-ws,Test123!</con:value></con:property></con:properties><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:sensitiveInformation/></con:soapui-project>